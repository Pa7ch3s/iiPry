import{g as w,r as R,a as S}from"./unit-test-feature-CNk-Sfkl.js";import{h as u}from"./chunk-WY5IRSCW-1dc6FieG.js";import{r as d}from"./chunk-OIYGIGL5-BYynBxW5.js";import{b as k,aK as v,d6 as c}from"./index-BnTlsbFl.js";import{S as l}from"./analytics-fpOjxorv.js";import{i as T}from"./invariant-DVddvGrP.js";import{c as h}from"./router-BoVIwh1i.js";async function x({params:i}){const{organizationId:e,projectId:s,workspaceId:r,testSuiteId:o}=i,n=await k.find(v.type,{parentId:o},{metaSortKey:1});T(n,"No unit tests found");const p=n.filter(t=>t!==null).map(t=>({name:t.name,code:t.code,defaultRequestId:t.requestId})),m=w([{name:"My Suite",suites:[],tests:p}]),I=S();let a={failures:[],passes:[],pending:[],stats:{suites:0,tests:0,passes:0,pending:0,failures:0,start:void 0,end:void 0,duration:void 0},tests:[]};try{a=await R(m,{sendRequest:I});const t=await c.create({results:a,parentId:r});return window.main.trackSegmentEvent({event:l.unitTestRunAll,properties:{organizationId:e,projectId:s}}),d(u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/test-result/:testResultId",{organizationId:e,projectId:s,workspaceId:r,testSuiteId:o,testResultId:t._id}))}catch(t){const f=t instanceof Error?t.toString():"Unknown error occurred";a.stats.failures=1,a.stats.tests=1,a.tests.push({currentRetry:0,duration:0,err:{actual:void 0,expected:void 0,message:f,multiple:[],operator:void 0,showDiff:!1,stack:""},file:"",fullTitle:"Test Error",id:"",title:"Test Error"});const g=await c.create({results:a,parentId:r});return window.main.trackSegmentEvent({event:l.unitTestRunAll,properties:{organizationId:e,projectId:s}}),d(u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/test-result/:testResultId",{organizationId:e,projectId:s,workspaceId:r,testSuiteId:o,testResultId:g._id}))}}const F=h(i=>({organizationId:e,projectId:s,workspaceId:r,testSuiteId:o})=>{const n=u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/run-all-tests",{organizationId:e,projectId:s,workspaceId:r,testSuiteId:o});return i({},{action:n,method:"POST"})});export{x as c,F as u};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.test.test-suite._testSuiteId.run-all-tests-D5hS-hnq.js.map
