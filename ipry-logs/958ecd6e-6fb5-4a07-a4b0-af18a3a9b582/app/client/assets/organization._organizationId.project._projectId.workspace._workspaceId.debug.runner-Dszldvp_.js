import{h as us}from"./chunk-WY5IRSCW-1dc6FieG.js";import{a as Ce,w as ms,k as fs,G as hs,c as xs}from"./chunk-OIYGIGL5-BYynBxW5.js";import{j as e}from"./jsx-runtime-cpqHEc2t.js";import{a7 as Re,b4 as ps,az as bs,aA as gs,a8 as js,aL as ue,cc as ws,d3 as _,a1 as ys,a2 as vs,a3 as Ns,d4 as $s,d5 as ks,bd as me}from"./index-BnTlsbFl.js";import{r as h,R as Cs}from"./index-b8gibUUP.js";import{$ as F}from"./Button-Pc6dXscm.js";import{u as Ie,bN as Rs,a4 as Is,ad as Ss,g as Ts,a5 as qs,az as Se,aA as Te,aB as A,aC as qe,aD as Ee,aE as O,b$ as Fe,y as Pe,a1 as Es,c0 as Fs,c1 as fe,a2 as K,c2 as Ae,o as Ps,h as As,$ as Os,aJ as Ds,be as Ls,bm as he,b9 as Us,ba as xe,bb as pe,a6 as be,a7 as ge,a8 as B,a9 as H,bt as Ms,c as zs,d as Bs,bl as Hs,ak as je,br as _s,bS as Ks}from"./trial.start-yrr1pYcE.js";import{$ as J}from"./Heading-CJLhoRaQ.js";import{c as Js,d as Ws,A as Vs,$ as we}from"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.update-CJN0pku1.js";import{a as ye,E as ve,b as Gs}from"./error-boundary-qQv-jeYH.js";import{aq as Qs,an as Xs}from"./index-wZAP8gf2.js";import{s as Ys}from"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.send-DoMmw_PP.js";import{S as Zs}from"./analytics-fpOjxorv.js";import{I as L}from"./icon-pbM3MSP9.js";import{d as Oe,e as De,f as Le,a as et,s as st}from"./index-CiWR7xsz.js";import{T as Ue}from"./tooltip-BiEx1s0w.js";import{f as tt}from"./format-i_2FlR3N.js";import{i as z}from"./invariant-DVddvGrP.js";function at(l,r,a,u){const t=l.slice(0,10);return r!==null&&r!==""?u?t+" -i "+r:t+" -i "+a.join(" -i "):u?t:t+" -i "+a.join(" -i ")}const rt=({onClose:l,requestIds:r,targetFolderId:a,keepManualOrder:u,iterationCount:t,delay:n,filePath:w,bail:j})=>{const{workspaceId:m}=Ce(),{activeEnvironment:b,activeGlobalEnvironment:c}=Ie(),N=at(m,a,r,u),f=t>1?` -n ${t}`:"",d=n>0?` --delay-request ${n}`:"",T=w?` -d "${w}"`:"",C=j?" --bail":"",R=c?` --globals ${c._id.slice(0,10)}`:"",I=`inso run collection ${N} -e ${b._id.slice(0,10)}${R}${f}${d}${T}${C}`;return e.jsx(Oe,{isOpen:!0,isDismissable:!0,onOpenChange:x=>{!x&&l()},className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-start justify-center bg-black/30",children:e.jsx(De,{className:"m-24 flex max-h-[75%] w-full max-w-[75%] flex-col overflow-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",onOpenChange:x=>{!x&&l()},children:e.jsx(Le,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:x})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(J,{slot:"title",className:"text-2xl",children:"Run via CLI"}),e.jsx(F,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:x,children:e.jsx(L,{icon:"x"})})]}),e.jsxs("div",{className:"h-full w-full flex-row p-2",children:[e.jsx("div",{className:"pb-4",children:"Copy this command to run your collection in the terminal"}),e.jsx("div",{className:"flex max-h-32 min-h-[2em] flex-col overflow-y-auto border border-solid border-[--hl-sm] bg-[--hl-xs] px-2 py-1",children:e.jsxs("div",{className:"relative flex h-full w-full justify-between gap-[var(--padding-sm)] overflow-auto font-mono",children:[e.jsx("span",{children:I}),e.jsx(Rs,{size:"small",content:I,title:"Copy Command",confirmMessage:"",className:"sticky top-0 self-start",children:e.jsx("i",{className:"fa fa-copy"})})]})})]}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx(F,{className:"flex items-center gap-2 rounded-sm border border-solid border-[--hl-md] px-3 py-2 text-[--hl] transition-colors hover:bg-opacity-90 hover:no-underline",onPress:x,children:"Close"})})]})})})})},Ne=[{key:"UTF-8",label:"UTF-8"},{key:"UTF-16LE",label:"UTF-16 LE"},{key:"UTF-16BE",label:"UTF-16 BE"},{key:"UTF-32LE",label:"UTF-32 LE"},{key:"UTF-32BE",label:"UTF-32 BE"},{key:"ASCII",label:"ASCII"},{key:"ISO-8859-1",label:"Western European (Latin-1)"},{key:"ISO-8859-2",label:"Central European (Latin-2)"},{key:"ISO-8859-3",label:"South European (Latin-3)"},{key:"ISO-8859-4",label:"North European (Latin-4)"},{key:"ISO-8859-5",label:"Cyrillic"},{key:"ISO-8859-6",label:"Arabic"},{key:"ISO-8859-7",label:"Greek"},{key:"ISO-8859-8",label:"Hebrew"},{key:"ISO-8859-9",label:"Turkish (Latin-5)"},{key:"ISO-8859-10",label:"Nordic (Latin-6)"},{key:"ISO-8859-11",label:"Thai"},{key:"ISO-8859-12",label:"Ethiopic"},{key:"ISO-8859-13",label:"Baltic (Latin-7)"},{key:"ISO-8859-14",label:"Celtic (Latin-8)"},{key:"ISO-8859-15",label:"Western European (Latin-9)"},{key:"ISO-8859-16",label:"Southeastern European (Latin-10)"},{key:"windows-1250",label:"Windows-1250"},{key:"windows-1251",label:"Windows-1251"},{key:"windows-1252",label:"Windows-1252"},{key:"windows-1253",label:"Windows-1253"},{key:"windows-1254",label:"Windows-1254"},{key:"windows-1255",label:"Windows-1255"},{key:"windows-1256",label:"Windows-1256"},{key:"windows-1257",label:"Windows-1257"},{key:"windows-1258",label:"Windows-1258"},{key:"GB18030",label:"GB 18030"},{key:"EUC-JP",label:"EUC-JP"},{key:"EUC-KR",label:"EUC-KR"},{key:"EUC-CN",label:"EUC-CN"},{key:"Big5",label:"Big5"},{key:"Shift_JIS",label:"Shift_JIS"},{key:"KOI8-R",label:"KOI8-R"},{key:"KOI8-U",label:"KOI8-U"},{key:"KOI8-RU",label:"KOI8-RU"},{key:"KOI8-T",label:"KOI8-T"}],lt=({encoding:l,onChange:r})=>e.jsxs(Is,{"aria-label":"Encoding Selector",className:"inline-block",selectedKey:l,onSelectionChange:a=>{a&&r(a)},defaultFilter:(a,u)=>{const t=Ne.find(n=>n.label===a)?.key||"";return!!Re(u,t,{splitSpace:!1,loose:!0})?.indexes||a.toLowerCase().includes(u.toLowerCase())},children:[e.jsxs(Ss,{className:"flex w-full min-w-64 border border-solid border-[--hl-sm] pr-2",children:[e.jsx(Ts,{className:"flex-1 px-2 py-1"}),e.jsx(F,{className:"flex items-center bg-transparent transition-all",children:e.jsx(L,{icon:"caret-down"})})]}),e.jsx(et,{className:"flex flex-col overflow-y-hidden",children:e.jsx(Js,{className:"max-h-80 select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-1 text-sm shadow-lg focus:outline-none",items:Ne,"aria-label":"Encoding List",autoFocus:!0,children:a=>e.jsx(Ws,{"aria-label":a.label,textValue:a.label,className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap rounded bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold data-[focused]:bg-[--hl-xs]",children:({isSelected:u})=>e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a.label}),u&&e.jsx(L,{icon:"check",className:"ml-1 justify-self-end text-[--color-success]"})]})})})})]}),$e="sticky normal-case top-[-8px] p-2 z-10 border-b border-[--hl-sm] bg-[--hl-xs] text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",nt="whitespace-nowrap text-sm font-medium border-b border-solid border-[--hl-sm] group-last-of-type:border-none focus:outline-none",ot=["application/json","text/csv"],ke=l=>{let r=[];const a=l.filter(t=>{const n=t&&typeof t=="object"&&!Array.isArray(t)&&t!==null;return n&&(r=r.concat(Object.keys(t))),n}),u=[...new Set(r)];return{data:a,headers:u}},it=({onUploadFile:l,onClose:r,userUploadData:a})=>{const[u,t]=h.useState(null),[n,w]=h.useState([]),[j,m]=h.useState([]),[b,c]=h.useState(""),[N,f]=h.useState(""),d=(x,g)=>{try{if(g==="application/json")try{const o=JSON.parse(x);if(Array.isArray(o)){const{data:p,headers:y}=ke(o);y.length>0&&p.length>0?(w(y),m(p)):f("Invalid JSON file uploaded, JSON file do not contain any key-value pair.")}else f("Invalid JSON file uploaded, JSON file must be array of key-value pairs.")}catch{f("Upload JSON file can not be parsed")}else if(g==="text/csv"){const o=x.replace(/\r\n|\r/g,`
`).split(`
`).map(p=>p.split(","));if(o.length>1){const p=o[0],v=o.slice(1).map(S=>p.reduce((P,U,k)=>(P[U]=S[k]??"",P),{}));w(p),m(v)}else f("CSV file must contain at least two rows with first row as variable names")}}catch(o){f(`Failed to read file ${o?.message}`)}},T=async x=>{if(f(""),m([]),!x)return;const o=Array.from(x)[0],p=o.type;if(!ot.includes(p)){f(`Uploaded file is unsupported ${o.type}`);return}const y=window.webUtils.getPathForFile(o);try{const{content:v,encoding:S}=await window.main.insecureReadFileWithEncoding({path:y});c(S),d(v,p)}catch(v){f(`Failed to read file ${v?.message}`);return}t(o)},C=async x=>{if(c(x),f(""),u){const g=window.webUtils.getPathForFile(u),o=u.type;try{const{content:p}=await window.main.insecureReadFileWithEncoding({path:g,encoding:x});d(p,o)}catch(p){f(`Failed to read file ${p?.message}`)}}},R=()=>{u&&j.length>=1&&l(u,j),r()},I=()=>{l(null,[]),r()};return h.useEffect(()=>{if(a.length>0){const{data:x,headers:g}=ke(a);w(g),m(x)}},[a]),e.jsx(Oe,{isOpen:!0,isDismissable:!0,onOpenChange:x=>{!x&&r()},className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-start justify-center bg-black/30",children:e.jsx(De,{className:"m-24 flex max-h-[75%] w-full max-w-3xl flex-col overflow-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",onOpenChange:x=>{!x&&r()},children:e.jsx(Le,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:x})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(J,{slot:"title",className:"text-2xl",children:a.length>0?"Update Data":"Preview Data"}),e.jsx(F,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:x,children:e.jsx(L,{icon:"x"})})]}),e.jsx("div",{className:"flex w-full shrink-0 grow basis-12 select-none flex-col gap-6 overflow-hidden overflow-y-auto rounded",children:e.jsx(qs,{allowsMultiple:!1,onSelect:T,acceptedFileTypes:[".csv",".json"],children:e.jsxs(F,{className:"flex flex-1 flex-shrink-0 items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-sm] px-2 py-1 text-base text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset aria-pressed:bg-[--hl-sm] aria-selected:bg-[--hl-sm]",children:[e.jsx(L,{icon:"upload"}),e.jsx("span",{children:j.length>0?"Change Data File":"Select Data File"})]})})}),u&&j.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"mr-4",children:"File Encoding"}),e.jsx(lt,{encoding:b,onChange:C})]}),N!==""&&e.jsx("div",{className:"notice error margin-top-sm",children:e.jsx("p",{children:N})}),j.length>0&&e.jsxs("div",{className:"flex-1 overflow-auto py-2",children:[e.jsx(J,{className:"margin-bottom-sm text-xl",children:"Data Preview"}),e.jsxs(Se,{"aria-label":"Data Preview Table",className:"min-w-full table-auto",children:[e.jsxs(Te,{children:[e.jsx(A,{isRowHeader:!0,className:$e,children:"Iteration"}),n.map((g,o)=>e.jsx(A,{className:$e,children:g},`${g}-${o}`))]}),e.jsx(qe,{children:j.map((g,o)=>e.jsxs(Ee,{children:[e.jsx(O,{className:nt,children:e.jsx("span",{className:"p-2",children:o+1})}),n.map(p=>e.jsx(O,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("span",{className:"p-2",children:typeof g[p]=="string"?g[p]:JSON.stringify(g[p])})},p))]},o))})]})]}),e.jsxs("div",{className:"mt-2 flex justify-end",children:[a.length>0&&e.jsx(F,{className:"flex items-center gap-2 rounded-sm border border-solid border-[--hl-md] px-3 py-2 text-[--hl] transition-colors hover:bg-opacity-90 hover:no-underline",onPress:I,children:"Remove Data"}),e.jsx(F,{isDisabled:j.length<1,className:"ml-4 flex items-center gap-2 rounded-sm border border-solid border-[--hl-md] bg-[--color-surprise] px-3 py-2 text-[--color-font-surprise] transition-colors hover:bg-opacity-90 hover:no-underline",onPress:R,children:"Upload"})]})]})})})})},ct=({history:l,gotoExecutionResult:r,gotoTestResultsTab:a,deleteHistoryItem:u})=>{const t=l.map(n=>{let w=0,j=0,m=0;for(const f of n.iterationResults)for(const d of f)for(const T of d.results)T.status==="failed"&&j++,T.status==="skipped"&&m++,T.status==="passed"&&w++;const{number:b,unit:c}=Fe(n.duration),N=tt(n.created,"yyyy-MM-dd HH:mm:ss");return e.jsxs(Ee,{className:"leading-9 hover:bg-[--hl-sm]",style:{outline:"none"},children:[e.jsx(O,{className:"capitalize hover:underline",children:e.jsxs("div",{onClick:()=>{r(n._id),a()},className:"cursor-pointer",children:[j===0?e.jsx("i",{className:"fa fa-circle-check fa-1x mr-2 text-green-500"}):e.jsx("i",{className:"fa fa-circle-xmark fa-1x mr-2 text-red-500"}),e.jsx(Pe,{children:e.jsx(Ue,{message:N,children:n.source})},`parent-folder-${n.created}`)]})}),e.jsx(O,{children:n.iterations}),e.jsx(O,{children:`${b} ${c}`}),e.jsx(O,{children:w+j+m}),e.jsx(O,{children:w}),e.jsx(O,{children:j}),e.jsx(O,{children:m}),e.jsx(O,{children:e.jsx(Es,{disabled:!1,confirmMessage:"",doneMessage:"",onClick:()=>u(n),children:e.jsx(L,{icon:"trash-can"})})})]},n._id)});return e.jsx(e.Fragment,{children:e.jsx("div",{className:"mb-12 flex h-full flex-col divide-y divide-solid divide-[--hl-md] overflow-y-auto",children:e.jsx(Fs,{className:"mt-3",children:e.jsxs(Se,{"aria-label":"Results",selectionMode:"multiple",className:"w-full text-center",children:[e.jsxs(Te,{children:[e.jsxs(A,{className:"leading-9",isRowHeader:!0,children:["Source",e.jsx(fe,{})]}),e.jsxs(A,{className:"leading-9",children:["Iterations",e.jsx(fe,{})]}),e.jsx(A,{className:"leading-9",children:"Duration"}),e.jsx(A,{className:"leading-9",children:"Total"}),e.jsx(A,{className:"leading-9",children:"Passed"}),e.jsx(A,{className:"leading-9",children:"Failed"}),e.jsx(A,{className:"leading-9",children:"Skipped"}),e.jsx(A,{className:"leading-9",children:"Delete"})]}),e.jsx(qe,{children:t})]})})})})},V="mx-1 w-[6rem] text-center rounded-md h-[--line-height-xxs] text-sm cursor-pointer outline-none select-none px-2 py-1 hover:bg-[rgba(var(--color-surprise-rgb),50%)] text-[--hl] aria-selected:text-[--color-font-surprise] hover:text-[--color-font-surprise] aria-selected:bg-[rgba(var(--color-surprise-rgb),40%)] transition-colors duration-300",G="text-white mx-1 w-[6rem] text-center rounded-md h-[--line-height-xxs] text-sm cursor-pointer outline-none select-none px-2 py-1 bg-[rgba(var(--color-surprise-rgb),50%)] text-[--hl] aria-selected:text-[--color-font-surprise] text-[--color-font-surprise] aria-selected:bg-[rgba(var(--color-surprise-rgb),40%)] transition-colors duration-300",Me=({requestTestResults:l,resultFilter:r,targetTests:a})=>{if(l.length===0)return e.jsx("div",{className:"my-3 w-full pl-3 text-sm text-neutral-400",children:"No test was detected, add test cases in scripts to see results."});const u=l.filter(t=>{switch(a){case"all":return!0;case"passed":return t.status==="passed";case"failed":return t.status==="failed";case"skipped":return t.status==="skipped";default:throw new Error(`unexpected target test type ${a}`)}}).filter(t=>r.trim()===""?!0:!!Re(r,t.testCase,{splitSpace:!1,loose:!0})?.indexes).map((t,n)=>{const w=ps.createHash("sha1").update(`${t.testCase}"-${n}`).digest("hex"),j={passed:"PASS",failed:"FAIL",skipped:"SKIP"}[t.status],m={passed:"bg-lime-600",failed:"bg-red-600",skipped:"bg-slate-600"}[t.status],b=e.jsx("span",{className:t.executionTime<300?"text-white-500":"text-red-500",children:t.executionTime===0?"< 0.1":`${t.executionTime.toFixed(1)}`}),c=e.jsx("div",{className:`inline-block w-16 rounded p-[2px] text-center text-xs font-semibold text-white ${m}`,children:j}),N=e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"capitalize",children:t.testCase}),e.jsx("span",{className:"text-neutral-400",children:t.errorMessage?" | "+t.errorMessage:""})]}),f=t.category==="pre-request"?"Pre-request Test":t.category==="after-response"?"After-response Test":"Unknown";return e.jsx("div",{"data-testid":"test-result-row",children:e.jsxs("div",{className:"my-3 flex w-full text-base",children:[e.jsx("div",{className:"m-auto mx-1 leading-4",children:e.jsx("span",{className:"ml-2 mr-2",children:c})}),e.jsxs("div",{className:"mr-2 leading-4",children:[e.jsx("div",{className:"my-1 mr-2 w-auto text-nowrap",children:N}),e.jsxs("div",{className:"my-1 text-sm text-neutral-400",children:[`${f} (`,b," ms)"]})]})]})},w)});return e.jsx(e.Fragment,{children:u})},Dt=({requestTestResults:l})=>{const[r,a]=h.useState("all"),[u,t]=h.useState(""),n=e.jsxs("div",{className:"mt-5 text-center",children:[e.jsx("div",{className:"",children:"No test result found"}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Add test cases in scripts and run them to see results."})]});if(l.length===0)return n;const w=()=>a("all"),j=()=>a("passed"),m=()=>a("failed"),b=()=>a("skipped");return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"test-result-pane flex h-full flex-col divide-y divide-solid divide-[--hl-md]",children:[e.jsxs("div",{className:"h-[calc(100%-var(--line-height-sm))]",children:[e.jsxs(K,{className:"box-border flex h-[--line-height-sm] flex-row items-center overflow-x-auto border-b border-solid border-b-[--hl-md] pl-2 text-[var(--font-size-sm)]",children:[e.jsx("button",{className:r==="all"?G:V,onClick:w,children:"All"}),e.jsx("button",{className:r==="passed"?G:V,onClick:j,children:"Passed"}),e.jsx("button",{className:r==="failed"?G:V,onClick:m,children:"Failed"}),e.jsx("button",{className:r==="skipped"?G:V,onClick:b,children:"Skipped"})]}),e.jsx("div",{className:"h-[calc(100%-var(--line-height-sm))] w-auto overflow-x-auto overflow-y-auto",children:e.jsx(Me,{requestTestResults:l,resultFilter:u,targetTests:r})})]}),e.jsx(K,{className:"box-border flex h-[--line-height-sm] flex-shrink-0 flex-row items-center overflow-x-auto text-[var(--font-size-sm)]",children:e.jsx("input",{type:"text",className:"flex-1 pl-3",title:"Filter test results",defaultValue:u||"",placeholder:"Filter test results with name",onChange:c=>{t(c.target.value)}},"test-results-filter")})]})})},Q="mx-1 w-[6rem] text-center rounded-md h-[--line-height-xxs] text-sm cursor-pointer outline-none select-none px-2 py-1 hover:bg-[rgba(var(--color-surprise-rgb),50%)] text-[--hl] aria-selected:text-[--color-font-surprise] hover:text-[--color-font-surprise] aria-selected:bg-[rgba(var(--color-surprise-rgb),40%)] transition-colors duration-300",X="text-white mx-1 w-[6rem] text-center rounded-md h-[--line-height-xxs] text-sm cursor-pointer outline-none select-none px-2 py-1 bg-[rgba(var(--color-surprise-rgb),50%)] text-[--hl] aria-selected:text-[--color-font-surprise] text-[--color-font-surprise] aria-selected:bg-[rgba(var(--color-surprise-rgb),40%)] transition-colors duration-300",dt=({result:l})=>{const[r,a]=h.useState("all"),[u,t]=h.useState(""),n=e.jsxs("div",{className:"mt-5 text-center",children:[e.jsx("div",{className:"",children:"No test result found"}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Add test cases in scripts and run them to see results."})]});if(!l||l.iterationResults.length===0)return n;const w=()=>a("all"),j=()=>a("passed"),m=()=>a("failed"),b=()=>a("skipped"),c=l.iterationResults.map((N,f)=>{const d=`runner-test-result-iteration-${f+1}`;if(Array.isArray(N)){const T=N.map((C,R)=>{const I=`request-test-result-${R}`;return e.jsxs("div",{children:[e.jsxs("div",{className:"pl-3",children:[e.jsx("span",{children:C.requestName}),e.jsx("span",{className:"text-sm text-neutral-400",children:` - ${C.requestUrl}`})]}),e.jsx(Me,{requestTestResults:C.results,resultFilter:u,targetTests:r})]},I)});return e.jsxs("div",{"data-testid":d,className:"border-b border-dashed border-b-[--hl-md] pb-6 pt-6",children:[e.jsxs("div",{className:"mb-3 pl-3 font-bold uppercase leading-10",children:[" Iteration ",f+1," "]}),e.jsx("div",{className:"border-1 border-solid border-gray-600"}),T]},d)}return e.jsx("div",{children:"Invalid test result format"},d)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex h-full flex-col divide-y divide-solid divide-[--hl-md]",children:[e.jsxs("div",{className:"h-[calc(100%-var(--line-height-sm))]",children:[e.jsxs(K,{className:"box-border flex h-[--line-height-sm] flex-row items-center overflow-x-auto border-b border-solid border-b-[--hl-md] pl-2 text-[var(--font-size-sm)]",children:[e.jsx("button",{className:r==="all"?X:Q,onClick:w,children:"All"}),e.jsx("button",{className:r==="passed"?X:Q,onClick:j,children:"Passed"}),e.jsx("button",{className:r==="failed"?X:Q,onClick:m,children:"Failed"}),e.jsx("button",{className:r==="skipped"?X:Q,onClick:b,children:"Skipped"})]}),e.jsx("div",{className:"h-[calc(100%-var(--line-height-sm))] w-auto overflow-x-auto overflow-y-auto",children:c})]}),e.jsx(K,{className:"box-border flex h-[--line-height-sm] flex-shrink-0 flex-row items-center overflow-x-auto text-[var(--font-size-sm)]",children:e.jsx("input",{type:"text",className:"flex-1 pl-3",title:"Filter test results",defaultValue:u||"",placeholder:"Filter test results with name",onChange:N=>{t(N.target.value)}},"test-results-filter")})]})})},ut=(l,r,a)=>{const{collection:u}=Ie(),t=h.useRef(new Map),n=h.useMemo(()=>u.filter(b=>(t.current.set(b.doc._id,b),bs(b.doc))).map(b=>{const c=[];b.ancestors&&b.ancestors.forEach(f=>{const d=t.current.get(f);d&&gs(d?.doc)&&c.push({id:d?.doc._id,name:d?.doc.name})});const N=b.doc;return z("method"in b.doc,"Only Request is supported at the moment"),{id:b.doc._id,name:b.doc.name,ancestors:c,method:N.method,url:b.doc.url,parentId:b.doc.parentId}}).filter(b=>r?b.ancestors.map(c=>c.id).includes(r):!0),[u,r]),{runnerStateMap:w,runnerStateRef:j,updateRunnerState:m}=Ae();return h.useEffect(()=>{j?.current?.[l]?.[a]||m(l,a,{reqList:n})},[l,n,a,j,m]),{reqList:w[l]?.[a]?.reqList||[],requestRows:n,entityMap:t.current}},mt="placeholder:italic py-0.5 mr-1.5 px-1 w-24 rounded-sm border-2 border-solid border-[--hl-sm] bg-[--color-bg] text-[--color-font] focus:outline-none focus:ring-1 focus:ring-[--hl-md] transition-colors",ft="placeholder:italic py-0.5 mr-1.5 px-1 w-16 rounded-sm border-2 border-solid border-[--hl-sm] bg-[--color-bg] text-[--color-font] focus:outline-none focus:ring-1 focus:ring-[--hl-md] transition-colors";async function ht(l,r){let a=[];const u=r.responsesInfo;for(const t of u){const n=await me.getById(t.responseId);if(n){const w=me.getTimeline(n,!0);a=[...a,{value:`------ Start of request (${t.originalRequestName}) ------`,name:"Text",timestamp:Date.now()},...w]}else a=[...a,{value:`------ Start of request (${t.originalRequestName}) ------`,name:"Text",timestamp:Date.now()},{value:`failed to read response for the request ${t.originalRequestName}`,name:"Text",timestamp:Date.now()}]}return l&&(a=[...a,{value:l,name:"Text",timestamp:Date.now()}]),a}const xt={bail:!0,keepLog:!0},pt=()=>{const[l]=fs(),[r,a]=h.useState(null),u=Ps(),t=l.get("folder")||"",{organizationId:n,projectId:w,workspaceId:j}=Ce(),[m,b]=h.useState(!1),c=t||j,{settings:N}=As(),[f,d]=h.useState(!1),[T,C]=h.useState(!1),[R,I]=h.useState(N.forceVerticalLayout?"vertical":"horizontal"),{runnerStateMap:x,updateRunnerState:g}=Ae(),{iterationCount:o=1,delay:p=0,selectedKeys:y=new Set,advancedConfig:v=xt,uploadData:S=[],file:P,filePath:U}=x?.[n]?.[c]||{};z(o,"iterationCount should not be null");const{reqList:k,requestRows:M,entityMap:Be}=ut(n,t,c);h.useEffect(()=>{if(N.forceVerticalLayout)return I("vertical"),()=>{};const s=window.matchMedia("(max-width: 880px)");I(s.matches?"vertical":"horizontal");const i=$=>{I($.matches?"vertical":"horizontal")};return s.addEventListener("change",i),()=>{s.removeEventListener("change",i)}},[N.forceVerticalLayout,R]);const He=h.useMemo(()=>M.length!==k.length||y!=="all"&&Array.from(y).length!==M.length?!0:M.some((s,i)=>s.id!==k[i].id),[k,M,y]),{dragAndDropHooks:_e}=Os({getItems:s=>[...s].map(i=>{const $=Be.get(i)?.doc.name||"";return{"text/plain":i.toString(),name:$}}),onReorder:s=>{let i=k;s.target.dropPosition==="before"?i=$s(k,s.target.key,s.keys):s.target.dropPosition==="after"&&(i=ks(k,s.target.key,s.keys)),g(n,c,{reqList:i})},renderDragPreview(s){return e.jsxs("div",{className:"rounded bg-slate-800 px-2 py-0.5",children:[e.jsx("mark",{className:"text-extrabold rounded bg-green-400 px-2 text-lg dark:bg-green-400",style:{color:"black"},children:` ${s.length}`})," ","item(s)"]})},renderDropIndicator(s){return s.type==="item"&&k.find($=>$.id===s.key)?e.jsx(we,{target:s,className:({isDropTarget:$})=>`${$?"border border-solid border-[--hl-sm]":""}`}):e.jsx(we,{target:s})}}),Ke=hs(),le=()=>{if(m)return;b(!0),window.main.trackSegmentEvent({event:Zs.collectionRunExecute,properties:{plan:u?.currentPlan?.type||"scratchpad",iterations:o}});const s=y==="all"?k:k.filter(q=>y.has(q.id)),i=S.map(q=>{const E=ys.parse(JSON.stringify(q||[]),vs,Ns);return{name:P.name,data:E.object,dataPropertyOrder:E.map||null}}),$={requests:s,iterationCount:o,userUploadEnvs:i,delay:p,bail:v?.bail,keepLog:v?.keepLog,targetFolderId:t||""};Ke(JSON.stringify($),{method:"POST",encType:"application/json",action:us("/organization/:organizationId/project/:projectId/workspace/:workspaceId/debug/runner",{organizationId:n,projectId:w,workspaceId:j}),navigate:!1})},Je=xs(),We=s=>{Je(`/organization/${n}/project/${w}/workspace/${j}/debug/request/${s}`)},Z=()=>{if(y==="all"||Array.from(y).length===Array.from(k).length)g(n,c,{selectedKeys:new Set([])});else{const s=k.map(i=>i.id);g(n,c,{selectedKeys:new Set(s)})}},[Ve,ne]=h.useState([]);h.useEffect(()=>{(async()=>{const i=await _.findByParentId(c)||[];ne(i.reverse())})()},[c]);const[Ge,Qe]=h.useState([]),[oe,Xe]=h.useState({duration:0,unit:"ms"}),[D,W]=h.useState(null),[Ye,ie]=h.useState([]),Ze=h.useCallback(async s=>{const i=await _.getById(s);i&&W(i)},[W]);h.useEffect(()=>{(async()=>{if(D){const i=await ht(r,D);ie(i)}else ie([])})()},[D,r]);const es=s=>{st(Vs,{title:"Unexpected Runner Failure",message:e.jsxs("div",{children:[e.jsx("p",{children:"The runner failed due to an unhandled error:"}),e.jsx("code",{className:"wide selectable",children:e.jsx("pre",{children:s})})]})})},ee=h.useCallback(async()=>{const s=await window.main.getExecution({requestId:c});let i=!1;if(s&&(i=s.length>0&&s[s.length-1].stepName!=="Done"),b(i),i){const $=Date.now()-s[s.length-1].startedAt,{number:q,unit:E}=Fe($);Qe(s),Xe({duration:q,unit:E})}else{const $=await _.findByParentId(c)||[];if($.length>0){ne($.reverse());const q=$[0];W(q);const{error:E}=re(c);E&&(a(E),es(E),ae(c,{error:""}))}else W(null),a(null)}},[c]);Ds(()=>{ee()},m?1e3:null),h.useEffect(()=>{ee()},[ee]);const{passedTestCount:ss,totalTestCount:ts,testResultCountTagColor:as}=h.useMemo(()=>{let s=0,i=0;if(!m&&D?.iterationResults)for(const q of D.iterationResults)for(const E of q)for(const ds of E.results)ds.status==="passed"&&s++,i++;const $=i>0?s===i?"bg-lime-600":"bg-red-600":"bg-[var(--hl-sm)]";return{passedTestCount:s,totalTestCount:i,testResultCountTagColor:$}},[D,m]),[rs,se]=Cs.useState("test-results"),ls=h.useCallback(()=>{se("test-results")},[se]),ce=k.map(s=>s.id),ns=h.useMemo(()=>m?ce:[],[m,ce]),te=m||Array.from(y).length===0,[de,os]=h.useState([]),is=s=>{_.remove(s),os([...de,s._id])},cs=t!==null&&t!==""?k.filter(s=>s.ancestors.map(i=>i.id).includes(t)).map(s=>s.id).filter(s=>y==="all"||y.has(s)):k.map(s=>s.id).filter(s=>y==="all"||y.has(s));return e.jsxs(e.Fragment,{children:[e.jsx(ye,{id:"pane-one",className:"pane-one theme--pane",minSize:35,maxSize:90,children:e.jsx(ve,{showAlert:!0,children:e.jsxs(Ls,{type:"request",children:[e.jsx(he,{children:e.jsxs(J,{className:"flex h-[--line-height-sm] w-full items-center pl-[--padding-md]",children:[e.jsx("div",{className:"h-full w-full overflow-hidden text-left",children:e.jsxs("div",{className:"h-full min-w-[500px]",children:[e.jsxs("span",{className:"mr-6 text-sm",children:[e.jsx("input",{value:o,name:"Iterations",disabled:m,onChange:s=>{try{parseInt(s.target.value,10)>0&&g(n,c,{iterationCount:parseInt(s.target.value,10)})}catch{}},type:"number",className:ft}),e.jsx("span",{className:"border",children:"Iterations"})]}),e.jsxs("span",{className:"mr-6 text-sm",children:[e.jsx("input",{value:p,disabled:m,name:"Delay",onChange:s=>{try{const i=parseInt(s.target.value,10);i>=0&&g(n,c,{delay:i})}catch{}},type:"number",className:mt}),e.jsx("span",{className:"mr-1 border",children:"Delay (ms)"})]}),e.jsxs(F,{onPress:()=>d(!0),className:"mr-6 h-full rounded-sm border-[--hl-sm] px-1 py-0.5 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] aria-pressed:bg-[--hl-sm]",isDisabled:m,children:[e.jsx(L,{icon:P?"eye":"upload"})," ",P?"View Data":"Upload Data"]})]})}),e.jsxs("div",{className:"flex self-stretch p-1",children:[e.jsx(F,{isDisabled:te,className:"ml-1 rounded-l-sm bg-[--color-surprise] px-5 text-[--color-font-surprise] hover:bg-opacity-90 focus:bg-opacity-90",onPress:le,children:"Run"}),e.jsxs(Us,{className:"flex",isDisabled:te,"aria-label":"Run Options",closeOnSelect:!1,triggerButton:e.jsx(F,{isDisabled:te,className:"rounded-r-sm bg-[--color-surprise] px-1 text-[--color-font-surprise]",style:{borderTopRightRadius:"0.125rem",borderBottomRightRadius:"0.125rem"},children:e.jsx("i",{className:"fa fa-caret-down"})}),children:[e.jsx(xe,{"aria-label":"send-now",children:e.jsx(pe,{icon:"arrow-circle-o-right",label:"Run",onClick:le})}),e.jsx(xe,{"aria-label":"Run via CLI",children:e.jsx(pe,{icon:"code",label:"Run via CLI",onClick:()=>C(!0)})})]},"dropdown")]})]})}),e.jsxs(be,{"aria-label":"Request group tabs",className:"flex h-full w-full flex-1 flex-col",children:[e.jsxs(ge,{className:"flex h-[--line-height-sm] w-full flex-shrink-0 items-center overflow-x-auto border-b border-solid border-b-[--hl-md] bg-[--color-bg]","aria-label":"Request pane tabs",children:[e.jsxs(B,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"request-order",children:[e.jsx("i",{className:"fa fa-sort fa-1x mr-2 h-4"}),"Request Order"]}),e.jsxs(B,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"advanced",children:[e.jsx("i",{className:"fa fa-gear fa-1x mr-2 h-4"}),"Advanced"]})]}),e.jsxs(H,{className:"flex w-full flex-1 flex-col overflow-hidden",id:"request-order",children:[e.jsx(K,{className:"flex h-[--line-height-sm] w-full flex-shrink-0 items-center border-b border-solid border-[--hl-md] px-2",children:e.jsx("span",{className:"mr-2",children:y==="all"||Array.from(y).length===Array.from(k).length?e.jsxs("span",{onClick:Z,children:[e.jsx("i",{style:{color:"rgb(74 222 128)"},className:"fa fa-square-check fa-1x mr-2 h-4"})," ",e.jsx("span",{className:"cursor-pointer",children:"Unselect All"})]}):Array.from(y).length===0?e.jsxs("span",{onClick:Z,children:[e.jsx("i",{className:"fa fa-square fa-1x mr-2 h-4"})," ",e.jsx("span",{className:"cursor-pointer",children:"Select All"})]}):e.jsxs("span",{onClick:Z,children:[e.jsx("i",{style:{color:"rgb(74 222 128)"},className:"fa fa-square-minus fa-1x mr-2 h-4"})," ",e.jsx("span",{className:"cursor-pointer",children:"Select All"})]})})}),e.jsx(Ms,{placeholder:!0,className:"p-0",children:e.jsx(zs,{id:"runner-request-list",items:k,selectionMode:"multiple",selectedKeys:y,onSelectionChange:s=>{g(n,c,{selectedKeys:s})},"aria-label":"Request Collection",dragAndDropHooks:_e,className:"h-full w-full overflow-auto text-base leading-8",disabledKeys:ns,children:s=>{const i=s.ancestors.map(({id:q,name:E})=>e.jsx(Pe,{children:e.jsxs(Ue,{message:E,children:[e.jsx("i",{className:"fa fa-folder fa-1x mr-0.3 h-4 text-[--color-font]"}),e.jsx("i",{className:"fa fa-caret-right fa-1x mr-0.3 text-[--color-font]-50 h-4 opacity-50"})]})},`parent-folder-${q}=${E}`)),$=i.length>0?e.jsx("span",{className:"ml-2",children:i}):null;return e.jsxs(Bs,{textValue:s.name,className:`runner-request-list-${s.name} border border-solid border-transparent text-[--color-font]`,style:{outline:"none"},children:[e.jsx(F,{slot:"drag",className:"hover:cursor-grab",children:e.jsx(L,{icon:"grip-vertical",className:"mr-2 w-2 text-[--hl]"})}),e.jsx(Hs,{slot:"selection",children:({isSelected:q})=>e.jsx(e.Fragment,{children:q?e.jsx("i",{className:"fa fa-square-check fa-1x mr-2 h-4",style:{color:"rgb(74 222 128)"}}):e.jsx("i",{className:"fa fa-square fa-1x mr-2 h-4"})})}),$,e.jsx("span",{className:`ml-2 text-xs uppercase http-method-${s.method}`,children:s.method}),e.jsx("span",{className:"ml-2 cursor-pointer text-[--hl] hover:underline",onClick:()=>We(s.id),children:s.name})]})}})})]}),e.jsx(H,{className:"align-center flex w-full flex-1 overflow-y-auto",id:"advanced",children:e.jsxs("div",{className:"w-full p-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{name:"persist-response",onChange:()=>{},type:"checkbox",disabled:!0}),"Persist responses for a session",e.jsx(je,{className:"space-left",children:"Enabling this will impact performance while responses are saved for other purposes."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{name:"enable-log",onChange:()=>{g(n,c,{advancedConfig:{...v,keepLog:!v?.keepLog}})},type:"checkbox",disabled:m,checked:v?.keepLog}),"Keep logs after run",e.jsx(je,{className:"space-left",children:"Disabling this will improve the performance while logs are not saved."})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{name:"bail",onChange:()=>{g(n,c,{advancedConfig:{...v,bail:!v?.bail}})},type:"checkbox",disabled:m,checked:v?.bail}),"Stop run if an error occurs"]})})]})})]}),T&&e.jsx(rt,{onClose:()=>C(!1),requestIds:cs,targetFolderId:t,keepManualOrder:!He,iterationCount:o,delay:p,filePath:U||"",bail:v?.bail}),f&&e.jsx(it,{onUploadFile:(s,i)=>{const $=s?window.webUtils.getPathForFile(s):"";g(n,c,{uploadData:i,file:s,filePath:$,iterationCount:i.length>=1?i.length:o})},userUploadData:S,onClose:()=>d(!1)})]})})}),e.jsx(Gs,{className:R==="horizontal"?"h-full w-[1px] bg-[--hl-md]":"h-[1px] w-full bg-[--hl-md]"}),e.jsxs(ye,{id:"pane-two",className:"pane-two theme--pane",children:[e.jsx(he,{className:"row-spaced",children:e.jsx(J,{className:"flex h-[--line-height-sm] w-full items-center border-b border-solid border-b-[--hl-md] pl-3",children:D?.duration?e.jsx("div",{className:"bg-info tag",children:e.jsx("strong",{children:`${oe.duration} ${oe.unit}`})}):e.jsx("span",{className:"font-bold",children:"Collection Runner"})})}),e.jsxs(be,{selectedKey:rs,onSelectionChange:se,"aria-label":"Request group tabs",className:"flex h-full w-full flex-1 flex-col",children:[e.jsxs(ge,{className:"flex h-[--line-height-sm] w-full flex-shrink-0 items-center overflow-x-auto border-b border-solid border-b-[--hl-md] bg-[--color-bg]","aria-label":"Request pane tabs",children:[e.jsx(B,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"test-results",children:e.jsxs("div",{children:[e.jsx("span",{children:"Tests"}),e.jsx("span",{className:`test-result-count ml-1 rounded-sm px-1 ${as}`,style:{color:"white"},children:`${ss} / ${ts}`})]})}),e.jsx(B,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"history",children:"History"}),e.jsx(B,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"console",children:"Console"})]}),e.jsx(H,{className:"flex w-full flex-1 flex-col overflow-hidden",id:"console",children:e.jsx(_s,{timeline:Ye},c)}),e.jsx(H,{className:"flex w-full flex-1 flex-col overflow-hidden",id:"history",children:e.jsx(ct,{history:Ve.filter(s=>!de.includes(s._id)),gotoExecutionResult:Ze,gotoTestResultsTab:ls,deleteHistoryItem:is})}),e.jsxs(H,{className:"flex w-full flex-1 flex-col overflow-y-auto",id:"test-results",children:[m&&e.jsx("div",{className:"flex h-full w-full items-center",children:e.jsx(Ks,{handleCancel:()=>ze(c),activeRequestId:c,steps:Ge})}),!m&&e.jsx(ve,{showAlert:!0,children:e.jsx(dt,{result:D})})]})]})]})]})},Lt=ms(pt),Y=new Map;function bt(l){Y.set(l,{})}function ae(l,r){const a=Y.get(l);Y.set(l,{...a,...r})}function re(l){return Y.get(l)||{}}function ze(l){const{activeRequestId:r}=re(l);r&&(Xs(r),window.main.completeExecutionStep({requestId:r}),window.main.updateLatestStepName({requestId:l,stepName:"Done"}),window.main.completeExecutionStep({requestId:l}))}const gt=(l,r)=>{if(!(r===void 0||!Array.isArray(l)||l.length===0))return l.length>=r+1?l[r]:l[(r+1)%l.length]};async function Ut({request:l,params:r}){const{organizationId:a,projectId:u,workspaceId:t}=r;z(a,"Organization id is required"),z(u,"Project id is required"),z(t,"Workspace id is required");const{requests:n,iterationCount:w,delay:j,userUploadEnvs:m,bail:b,targetFolderId:c,keepLog:N}=await l.json(),f=c||t;let d={source:"runner",environmentId:"",iterationCount:w,iterationData:m,duration:0,testCount:0,avgRespTime:0,iterationResults:[],done:!1,responsesInfo:[],transientVariables:{...ue.init(),_id:js(),type:ue.type,parentId:"",modified:0,created:Date.now(),name:"Transient Variables",data:{}}};window.main.startExecution({requestId:f}),window.main.addExecutionStep({requestId:f,stepName:"Initializing"}),bt(f);const T={appendTimeline:async(C,R)=>{}};try{const C=N?Qs:T;for(let R=0;R<w;R++){let I="",x=[],g=0;for(;g<n.length;){if(re(f)===void 0)throw new Error("Runner has been stopped");const o=n[g],p={requestId:o.id,requestName:o.name,requestUrl:o.url,statusCode:0,duration:0,size:0,results:[],responseId:""},y=(v,S)=>{const P=v.id===S,U=v.name.trim()===S.trim(),k=g===n.findLastIndex(M=>M.name.trim()===S.trim());return P||U&&k};try{if(I!=="")if(y(o,I))I="";else continue;ae(f,{activeRequestId:o.id}),window.main.updateLatestStepName({requestId:f,stepName:`Iteration ${R+1} - Executing ${g+1} of ${n.length} requests - "${o.name}"`});const v=await ws.updateOrCreateByParentId(o.id,{lastActive:Date.now()});z(v,"Request meta not found"),await new Promise(U=>setTimeout(U,j));const S=await Ys({requestId:o.id,iteration:R+1,iterationCount:w,userUploadEnvironment:gt(m,R),shouldPromptForPathAfterResponse:!1,ignoreUndefinedEnvVariable:!0,testResultCollector:p,runtime:C,transientVariables:d.transientVariables});S?.nextRequestIdOrName&&(I=S.nextRequestIdOrName||"");const P={requestName:o.name,requestUrl:o.url,responseCode:p.statusCode,results:p.results};x=[...x,P],d={...d,duration:d.duration+p.duration,responsesInfo:[...d.responsesInfo,{responseId:p.responseId,originalRequestId:o.id,originalRequestName:o.name}]}}catch(v){const S={requestName:o.name,requestUrl:o.url,responseCode:p.statusCode,results:p.results};if(x=[...x,S],d={...d,responsesInfo:[...d.responsesInfo,{responseId:p.responseId||"",originalRequestId:o.id,originalRequestName:o.name}]},b)throw d={...d,iterationResults:[...d.iterationResults,x]},v;I=""}finally{y(o,I)||g++}}d={...d,iterationResults:[...d.iterationResults,x]}}window.main.updateLatestStepName({requestId:f,stepName:"Done"}),window.main.completeExecutionStep({requestId:f})}catch(C){const R=C.message||C.error||C;return ae(f,{error:R}),null}finally{ze(f),await _.create({parentId:f,source:d.source,iterations:d.iterationCount,duration:d.duration,avgRespTime:d.avgRespTime,iterationResults:d.iterationResults,responsesInfo:d.responsesInfo})}return null}export{Dt as R,Lt as a,Ut as c};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.debug.runner-Dszldvp_.js.map
