import{i as Ws,j as Vs,k as Ks,l as Y,m as Js,s as T,M as Ys,n as Qs,o as Zs,p as Xs,g as et,$ as Fe,a as Pe,b as De,q as Q,r as st,c as Z,d as le,e as ie,f as ce,t as tt}from"./index-CiWR7xsz.js";import{$ as rt,b as at,h as ot,g as nt}from"./utils-BWA8Q1_N.js";import{aj as lt,ak as Ie,al as it,am as ct,a6 as dt,a7 as mt,a8 as ve,a9 as Ne,an as ut,ao as ht,ap as ft,u as ze,aq as xt,b as Ue,ar as $e,P as pt,as as Ae,at as Oe,au as gt,av as bt,Q as jt,aw as wt,ax as yt,k as we,g as He,c as X,d as ee,a1 as he,ay as qe,az as We,aA as Ve,aB as K,aC as Ke,aD as Je,aE as J,T as Ye,y as z,B as U,aF as Qe,aG as je,aH as Ze,aI as vt,aJ as Xe,h as es,aK as Nt,aL as $t,a as kt,L as St,G as Ct,aM as Ft,i as Pt,aN as Te}from"./trial.start-yrr1pYcE.js";import{n as Me,$,a as ye}from"./Button-Pc6dXscm.js";import{r as h,R as ne}from"./index-b8gibUUP.js";import{$ as Dt}from"./index-BBURUpBQ.js";import{j as e}from"./jsx-runtime-cpqHEc2t.js";import{$ as O}from"./Heading-CJLhoRaQ.js";import{h as ss}from"./chunk-WY5IRSCW-1dc6FieG.js";import{a as q,c as Mt,j as ts,f as Bt,k as Et,m as At}from"./chunk-OIYGIGL5-BYynBxW5.js";import{u as Ot}from"./organization._organizationId.project._projectId.workspace.update-BTK7AG3H.js";import{b as Tt,ay as Lt,az as Gt,aA as _t,aB as Rt,aC as ke,aD as It,r as xe,aE as zt,J as Se}from"./index-BnTlsbFl.js";import{k as Ut,l as Ht,m as qt,n as Wt,o as Vt}from"./index-wZAP8gf2.js";import{u as Kt}from"./organization._organizationId.project._projectId.workspace._workspaceId.mock-server.generate-request-collection-DcBFb32H.js";import{i as Jt}from"./invariant-DVddvGrP.js";import{S as be}from"./analytics-fpOjxorv.js";import{I as m}from"./icon-pbM3MSP9.js";import{u as Be}from"./git.branch.checkout-24mct9lT.js";import{u as Yt}from"./git.fetch-V7uv_IT7.js";import{u as Qt}from"./git.push-C-wcZJjF.js";import{u as Zt}from"./git.repo-BBQti4ki.js";import{u as rs}from"./git.reset-DI5KZlh1.js";import{u as Xt}from"./git.status-qLD8fOhB.js";import{A as L,e as er}from"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.update-CJN0pku1.js";import{u as sr}from"./git.branch.delete-BnBpM4jO.js";import{u as tr}from"./git.branch.new-BvBAmjXB.js";import{u as rr}from"./git.branches-DSfOBTH4.js";import{u as as}from"./git.changes-CufBSoA0.js";import{u as ar}from"./git.log-VScJjeAs.js";import{u as or}from"./git.update-Ct4Hysyl.js";import{E as nr}from"./error-boundary-qQv-jeYH.js";import{$ as lr}from"./tooltip-BiEx1s0w.js";import"./index-B0jEcytd.js";import{u as ir}from"./git.commit-BOTBEKdr.js";import{u as cr}from"./git.diff-rvyD93UG.js";import{u as dr}from"./git.stage-WRvQ9YR0.js";import{u as Le}from"./git.unstage-BG9AvbEd.js";import{u as os}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.checkout-BFdhyIzf.js";import{u as mr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.pull-BJpkfRkS.js";import{u as ur}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.push-CfM5amSb.js";import{u as hr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.rollback-DbuDWqiP.js";import{u as fr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.create-BD-JEB_S.js";import{u as ns}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.delete-Ck9dZ7bb.js";import{u as xr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.merge-C_Hlo7i6.js";import{u as pr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.fetch-DiAT7xDA.js";import{u as gr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.restore-DzaYuRyT.js";import{t as Ge}from"./import-DfaWnrdO.js";import{u as br}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.create-snapshot-DMfKO0YH.js";import{u as jr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.stage-DakA5DCx.js";import{u as wr}from"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.unstage-fOL91F5Y.js";import{s as _}from"./ai.generate-commit-messages-D7XzOLO8.js";var ls={};ls={breadcrumbs:"عناصر الواجهة"};var is={};is={breadcrumbs:"Трохи хляб"};var cs={};cs={breadcrumbs:"Popis cesty"};var ds={};ds={breadcrumbs:"Brødkrummer"};var ms={};ms={breadcrumbs:"Breadcrumbs"};var us={};us={breadcrumbs:"Πλοηγήσεις breadcrumb"};var hs={};hs={breadcrumbs:"Breadcrumbs"};var fs={};fs={breadcrumbs:"Migas de pan"};var xs={};xs={breadcrumbs:"Lingiread"};var ps={};ps={breadcrumbs:"Navigointilinkit"};var gs={};gs={breadcrumbs:"Chemin de navigation"};var bs={};bs={breadcrumbs:"שבילי ניווט"};var js={};js={breadcrumbs:"Navigacijski putovi"};var ws={};ws={breadcrumbs:"Morzsamenü"};var ys={};ys={breadcrumbs:"Breadcrumb"};var vs={};vs={breadcrumbs:"パンくずリスト"};var Ns={};Ns={breadcrumbs:"탐색 표시"};var $s={};$s={breadcrumbs:"Naršymo kelias"};var ks={};ks={breadcrumbs:"Atpakaļceļi"};var Ss={};Ss={breadcrumbs:"Navigasjonsstier"};var Cs={};Cs={breadcrumbs:"Broodkruimels"};var Fs={};Fs={breadcrumbs:"Struktura nawigacyjna"};var Ps={};Ps={breadcrumbs:"Caminho detalhado"};var Ds={};Ds={breadcrumbs:"Categorias"};var Ms={};Ms={breadcrumbs:"Miez de pâine"};var Bs={};Bs={breadcrumbs:"Навигация"};var Es={};Es={breadcrumbs:"Navigačné prvky Breadcrumbs"};var As={};As={breadcrumbs:"Drobtine"};var Os={};Os={breadcrumbs:"Putanje navigacije"};var Ts={};Ts={breadcrumbs:"Sökvägar"};var Ls={};Ls={breadcrumbs:"İçerik haritaları"};var Gs={};Gs={breadcrumbs:"Навігаційна стежка"};var _s={};_s={breadcrumbs:"导航栏"};var Rs={};Rs={breadcrumbs:"導覽列"};var Is={};Is={"ar-AE":ls,"bg-BG":is,"cs-CZ":cs,"da-DK":ds,"de-DE":ms,"el-GR":us,"en-US":hs,"es-ES":fs,"et-EE":xs,"fi-FI":ps,"fr-FR":gs,"he-IL":bs,"hr-HR":js,"hu-HU":ws,"it-IT":ys,"ja-JP":vs,"ko-KR":Ns,"lt-LT":$s,"lv-LV":ks,"nb-NO":Ss,"nl-NL":Cs,"pl-PL":Fs,"pt-BR":Ps,"pt-PT":Ds,"ro-RO":Ms,"ru-RU":Bs,"sk-SK":Es,"sl-SI":As,"sr-SP":Os,"sv-SE":Ts,"tr-TR":Ls,"uk-UA":Gs,"zh-CN":_s,"zh-TW":Rs};function yr(s){return s&&s.__esModule?s.default:s}function vr(s){let{"aria-label":l,...a}=s,t=Dt(yr(Is),"@react-aria/breadcrumbs");return{navProps:{...Me(a,{labelable:!0}),"aria-label":l||t.format("breadcrumbs")}}}const Ce=h.createContext(null),La=h.forwardRef(function(l,a){[l,a]=rt(l,a,Ce);let{CollectionRoot:t}=h.useContext(Vs),{navProps:o}=vr(l),r=Me(l,{global:!0});return ne.createElement(Ks,{content:ne.createElement(Y,l)},i=>{var d;return ne.createElement("ol",{ref:a,...at(r,o),slot:l.slot||void 0,style:l.style,className:(d=l.className)!==null&&d!==void 0?d:"react-aria-Breadcrumbs"},ne.createElement(Ce.Provider,{value:l},ne.createElement(t,{collection:i})))})});class zs extends Js{}zs.type="item";const Ga=Ws(zs,function(l,a,t){let o=t.nextKey==null,{isDisabled:r,onAction:i}=ot(Ce),d={"aria-current":o?"page":null,isDisabled:r||o,onPress:()=>i?.(t.key)},p=nt({...t.props,children:t.rendered,values:{isDisabled:r||o,isCurrent:o},defaultClassName:"react-aria-Breadcrumb"}),y=Me(l,{global:!0});return delete y.id,ne.createElement("li",{...y,...p,ref:a,"data-disabled":r||o||void 0,"data-current":o||void 0},ne.createElement(lt.Provider,{value:d},p.children))});function Nr(s){return s?"oauth2format"in s&&s.oauth2format?s.oauth2format:"custom":"github"}const Us=({gitRepository:s,...l})=>{const{projectId:a,workspaceId:t}=q(),o=h.useRef(null),r=or(),i=rs(),[d,p]=h.useState(Nr(s?.credentials));h.useEffect(()=>{o.current?.show()},[]);const y=v=>{const{author:f,credentials:w,uri:g}=v;r.submit({projectId:a,workspaceId:t,uri:g||"",author:{email:f?.email||"",name:f?.name||""},credentials:w||{password:"",username:""}})},u=r.state!=="idle",P=!!s,M=r.data?.errors;return h.useEffect(()=>{if(M&&M.length){const v=M.map(f=>f instanceof Error?f.message:typeof f=="string"&&f).join(", ");T(L,{title:"Error Cloning Repository",message:v})}},[M]),e.jsx(lr,{children:e.jsxs(Ys,{ref:o,...l,children:[e.jsxs(Qs,{children:["Repository Settings"," ",e.jsxs(Ie,{children:["Sync and collaborate with Git",e.jsx("br",{}),e.jsxs(it,{href:ct,children:["Documentation ",e.jsx("i",{className:"fa fa-external-link-square"})]})]})]}),e.jsx(Zs,{children:e.jsx(nr,{children:e.jsxs(dt,{selectedKey:d,isDisabled:u||P,onSelectionChange:v=>{p(v)},"aria-label":"Git repository settings tabs",className:"flex h-full w-full flex-1 flex-col",children:[e.jsxs(mt,{className:"flex h-[--line-height-sm] w-full flex-shrink-0 items-center overflow-x-auto border-b border-solid border-b-[--hl-md] bg-[--color-bg]","aria-label":"Request pane tabs",children:[e.jsx(ve,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"github",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa fa-github"})," GitHub"]})}),e.jsx(ve,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"gitlab",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa fa-gitlab"})," GitLab"]})}),e.jsx(ve,{className:"flex h-full flex-shrink-0 cursor-pointer select-none items-center justify-between gap-2 px-3 py-1 text-[--hl] outline-none transition-colors duration-300 hover:bg-[--hl-sm] hover:text-[--color-font] focus:bg-[--hl-sm] aria-selected:bg-[--hl-xs] aria-selected:text-[--color-font] aria-selected:hover:bg-[--hl-sm] aria-selected:focus:bg-[--hl-sm]",id:"custom",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fa fa-code-fork"})," Git"]})})]}),e.jsx(Ne,{className:"h-full w-full overflow-y-auto py-2",id:"github",children:e.jsx(ut,{uri:s?.uri,onSubmit:y})}),e.jsx(Ne,{className:"h-full w-full overflow-y-auto py-2",id:"gitlab",children:e.jsx(ht,{uri:s?.uri,onSubmit:y})}),e.jsx(Ne,{className:"h-full w-full overflow-y-auto py-2",id:"custom",children:e.jsx(ft,{gitRepository:s,onSubmit:y})})]})})}),e.jsx(Xs,{children:e.jsxs("div",{style:{display:"flex",gap:"var(--padding-md)"},children:[e.jsx("button",{className:"btn",disabled:!P,onClick:()=>{i.submit({projectId:a,workspaceId:t})},children:"Reset"}),P?e.jsx("button",{type:"button",onClick:()=>o.current?.hide(),className:"btn","data-testid":"git-repository-settings-modal__sync-btn-close",children:"Close"}):e.jsx("button",{type:"submit",disabled:u,form:d,className:"btn","data-testid":"git-repository-settings-modal__sync-btn",children:"Sync"})]})})]})})},_a=()=>{const{organizationId:s,projectId:l,workspaceId:a}=q();Jt(s,"Expected organizationId");const{activeWorkspace:t,activeWorkspaceMeta:o,activeProject:r,activeMockServer:i}=ze(),[d,p]=h.useState(!1),[y,u]=h.useState(!1),[P,M]=h.useState(!1),[v,f]=h.useState(!1),w=Ot(),[g,N]=h.useState(!1),x=xt(),[B,j]=h.useState([]),[n,c]=h.useState({}),k=Mt(),E=Kt();h.useEffect(()=>{p(!1)},[a]),Ue({workspace_showSettings:()=>f(!0)});const S=h.useCallback(async({action:C,plugin:A,label:W},me)=>{c({...n,[W]:!0});try{const V={...Wt(),...qt(r._id),...Ht(A),...Ut()},te=await Tt.getWithDescendants(me,[Lt.type]),ue=te.filter(Gt).filter(ae=>!ae.isPrivate),re=te.filter(_t);await C(V,{requestGroups:re,requests:ue,workspace:me})}catch(V){et({title:"Plugin Action Failed",error:V})}c({...n,[W]:!1})},[r._id,n]),I=h.useCallback(async()=>{const C=await Vt();j(C)},[]),se=Rt(t),de=[{name:"Actions",id:"Actions",icon:"cog",items:[{id:"Import",name:"Import",icon:e.jsx(m,{icon:"file-import"}),action:()=>{window.main.trackSegmentEvent({event:be.importStarted,properties:{source:`scratchpad-${t.scope}-menu`}}),u(!0)}},{id:"Export",name:"Export",icon:e.jsx(m,{icon:"file-export"}),action:()=>(window.main.trackSegmentEvent({event:be.exportStarted,properties:{source:`scratchpad-${t.scope}-menu`}}),t.scope==="mock-server"?Ae(t):t.scope==="environment"?Oe(t):M(!0))}]}],D=[...ke(t)?[]:[{name:"Import",id:"import",icon:"cog",items:[{id:"from-file",name:"From File",icon:e.jsx(m,{icon:"file-import"}),action:()=>{window.main.trackSegmentEvent({event:be.importStarted,properties:{source:`${t.scope}-menu`}}),u(!0)}}]},{name:"Runner",id:"runner",icon:"circle-play",items:[{id:"run",name:"Run Collection",icon:e.jsx(m,{icon:"circle-play"}),action:()=>{k(`/organization/${s}/project/${t.parentId}/workspace/${t._id}/debug/runner?folder=`)}}]}],{name:"Actions",id:"actions",icon:"cog",items:[...ke(t)?[]:[{id:"duplicate",name:"Duplicate",icon:e.jsx(m,{icon:"bars"}),action:()=>p(!0)}],{id:"rename",name:"Rename",icon:e.jsx(m,{icon:"pen-to-square"}),action:()=>T(pt,{title:`Rename ${$e(t).singular}`,defaultValue:t.name,submitName:"Rename",selectText:!0,label:"Name",onComplete:C=>w.submit({organizationId:s,projectId:t.parentId,patch:{name:C,workspaceId:t._id}})})},...ke(t)?[]:[{id:"export",name:"Export",icon:e.jsx(m,{icon:"file-export"}),action:()=>(window.main.trackSegmentEvent({event:be.exportStarted,properties:{source:`${t.scope}-menu`}}),t.scope==="mock-server"?Ae(t):t.scope==="environment"?Oe(t):M(!0))},...t.scope==="mock-server"?[{id:"generate-collection",name:"Generate Collection",icon:e.jsx(m,{icon:"code"}),action:()=>{E.submit({organizationId:s,projectId:t.parentId,workspaceId:t._id})}}]:[]],{id:"settings",name:"Settings",icon:e.jsx(m,{icon:"wrench"}),action:()=>f(!0)},{id:"delete",name:"Delete",icon:e.jsx(m,{icon:"trash"}),action:()=>N(!0)}]},...B.length>0?[{name:"Plugins",id:"plugins",icon:"plug",items:B.map(C=>({id:C.label,name:C.label,icon:e.jsx(m,{icon:C.icon||"plug"}),action:()=>S(C,t)}))}]:[]],G=se?de:D;return e.jsxs(e.Fragment,{children:[e.jsxs(Fe,{onOpenChange:C=>C&&I(),children:[e.jsxs($,{"aria-label":"Workspace actions","data-testid":"workspace-context-dropdown",className:"flex h-7 flex-1 items-center justify-center gap-2 truncate rounded-sm px-3 py-1 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsx("span",{className:"truncate",title:t.name,children:t.name}),e.jsx(m,{icon:"caret-down"})]}),e.jsx(Pe,{className:"flex min-w-max flex-col overflow-y-hidden",children:e.jsx(De,{"aria-label":"Create in project actions",selectionMode:"single",onAction:C=>G.find(A=>A.items.find(W=>W.id===C))?.items.find(A=>A.id===C)?.action(),items:G,className:"min-w-max select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-2 text-sm shadow-lg focus:outline-none",children:C=>e.jsxs(Q,{className:"flex flex-1 flex-col",children:[e.jsxs(st,{className:"flex items-center gap-2 py-1 pl-2 text-xs uppercase text-[--hl]",children:[e.jsx(m,{icon:C.icon})," ",e.jsx("span",{children:C.name})]}),e.jsx(Y,{items:C.items,children:A=>e.jsxs(Z,{id:A.id,className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-selected:font-bold","aria-label":A.name,children:[A.icon,e.jsx("span",{children:A.name}),A.hint&&e.jsx(gt,{keyBindings:A.hint})]},A.id)})]})})})]}),d&&e.jsx(bt,{onHide:()=>p(!1),workspace:t}),y&&e.jsx(jt,{onHide:()=>u(!1),from:{type:"file"},projectName:r.name??It(),workspaceName:t.name,organizationId:s,defaultProjectId:l,defaultWorkspaceId:a}),P&&e.jsx(wt,{workspaceIdToExport:t._id,onClose:()=>M(!1)}),v&&e.jsx(yt,{workspace:t,mockServer:i,project:r,gitFilePath:o?.gitFilePath,onClose:()=>f(!1)}),g&&e.jsx(le,{isOpen:!0,onOpenChange:()=>{N(!1)},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:()=>{N(!1)},className:"max-h-full w-full max-w-2xl rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"outline-none",children:({close:C})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs(O,{className:"text-2xl",children:["Delete ",$e(t).singular]}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:C,children:e.jsx(m,{icon:"x"})})]}),e.jsxs(x.Form,{action:ss("/organization/:organizationId/project/:projectId/workspace/delete",{organizationId:s,projectId:t.parentId}),method:"POST",className:"flex flex-col gap-4",children:[e.jsx("input",{type:"hidden",name:"workspaceId",value:t._id}),e.jsxs("p",{children:["This will permanently delete the"," ",e.jsx("strong",{style:{whiteSpace:"pre-wrap"},children:t?.name})," ",$e(t).singular," ",xe(r)?"remotely":"","."]}),x.data&&x.data.error&&e.jsx("p",{className:"notice error margin-bottom-sm no-margin-top",children:x.data.error}),e.jsx("div",{className:"flex justify-end",children:e.jsx($,{type:"submit",className:"rounded-sm border border-solid border-[--hl-md] bg-[--color-danger] px-3 py-2 text-[--color-font-danger] transition-colors hover:bg-opacity-90 hover:no-underline",children:"Delete"})})]})]})})})})]})},$r=({branch:s,isCurrent:l,projectId:a,workspaceId:t,hasUncommittedChanges:o})=>{const r=Be(),i=sr();h.useEffect(()=>{if(r.data&&"errors"in r.data&&r.data.errors&&r.state==="idle"){const u=r.data.errors[0]||"An unexpected error occurred while checking out the branch.";T(L,{title:"Error while checking out branch.",message:u})}},[r.data,r.state]),h.useEffect(()=>{if(i.data&&"errors"in i.data&&i.data.errors&&i.state==="idle"){const u=i.data.errors[0]||"An unexpected error occurred while deleting the branch.";T(L,{title:"Error while deleting branch",message:u})}},[i.data,i.state]);const[d,p]=h.useState(""),{revalidate:y}=ts();return e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsxs("div",{className:"flex w-full items-center",children:[e.jsxs("span",{className:"flex-1 truncate",children:[s," ",l?"*":""]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s!=="master"&&e.jsxs(he,{confirmMessage:"Confirm",className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",doneMessage:"Deleted",disabled:l||s==="master",onClick:()=>{p(""),i.submit({projectId:a,workspaceId:t,branch:s})},children:[e.jsx(m,{icon:i.state!=="idle"?"spinner":"trash",className:`w-5 text-[--color-danger] ${i.state!=="idle"?"animate-spin":""}`}),"Delete"]}),e.jsxs($,{className:"flex items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",isDisabled:l,onPress:()=>{p(""),r.submit({projectId:a,workspaceId:t,branch:s})},children:[e.jsx(m,{icon:r.state!=="idle"?"spinner":"turn-up",className:`w-5 ${r.state!=="idle"?"animate-spin":"rotate-90"}`}),"Checkout"]}),e.jsxs(he,{className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",doneMessage:"Merged",confirmMessage:"Confirm",loadingMessage:"Merging",disabled:l,referToOnClickReturnValue:!0,onClick:async()=>{p(""),o&&p("You have uncommitted changes in your working tree. Please commit or discard them before merging.");try{const u=await window.main.git.mergeGitBranch({projectId:a,workspaceId:t,theirsBranch:s,allowUncommittedChangesBeforeMerge:!0});"conflicts"in u&&await new Promise((P,M)=>{T(qe,{conflicts:u.conflicts,labels:u.labels,onResolveAll:v=>{window.main.git.continueMerge({projectId:a,workspaceId:t,handledMergeConflicts:v,commitMessage:u.commitMessage,commitParent:u.commitParent}).then(P,M).finally(()=>{window.main.git.canPushLoader({projectId:a,workspaceId:t}),y()})},onCancelUnresolved:()=>{M(new Error("You aborted the merge, no changes were made to working tree."))}})}),"errors"in u&&u.errors&&u.errors?.length>0&&p(u.errors.join(`
`)),y()}catch(u){const P=u instanceof Error?u.message:"An unexpected error occurred while merging the branches.";p(P)}},children:[e.jsx(m,{icon:"code-merge",className:"w-5"}),"Merge"]})]})]}),d&&e.jsx("div",{className:"whitespace-break-spaces text-right text-[--color-danger]",children:d})]})},kr=({branch:s,projectId:l,workspaceId:a})=>{const t=Be();return h.useEffect(()=>{if(t.data&&"errors"in t.data&&t.data.errors&&t.state==="idle"){const o=t.data.errors[0]||"An unexpected error occurred while pulling the branch.";T(L,{title:"Error while pulling branch.",message:o})}},[t.data,t.state]),e.jsxs("div",{className:"flex w-full items-center",children:[e.jsx("span",{className:"flex-1 truncate",children:s}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs($,{className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:()=>t.submit({projectId:l,workspaceId:a,branch:s}),children:[e.jsx(m,{icon:t.state!=="idle"?"spinner":"cloud-arrow-down",className:`w-5 ${t.state!=="idle"?"animate-spin":""}`}),"Fetch and checkout"]})})]})};function _e(s,l){return s==="master"?-1:l==="master"?1:s.localeCompare(l)}const Sr=({currentBranch:s,branches:l,onClose:a})=>{const{organizationId:t,projectId:o,workspaceId:r}=q(),i=rr(),d=tr(),p=i.data&&"errors"in i.data?i.data.errors:[],{remoteBranches:y,branches:u}=i.data&&"branches"in i.data?i.data:{branches:[],remoteBranches:[]},P=u.length>0?u:l,M=y.filter(N=>!P.includes(N)),v=i.state!=="idle";h.useEffect(()=>{i.state==="idle"&&!i.data&&i.load({projectId:o,workspaceId:r})},[i,t,o,r]);const f=d.data?.errors&&d.data.errors.length>0?d.data.errors[0]:null,w=as();h.useEffect(()=>{w.state==="idle"&&!w.data&&w.load({projectId:o,workspaceId:r})},[o,r,w]);const g=!!(w.data?.changes&&(w.data.changes.staged.length>0||w.data.changes.unstaged.length>0));return e.jsx(le,{isOpen:!0,onOpenChange:N=>{!N&&a()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:N=>{!N&&a()},className:"flex max-h-full w-full max-w-4xl flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:N})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-2",children:[e.jsx(O,{slot:"title",className:"text-2xl",children:"Branches"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:N,children:e.jsx(m,{icon:"x"})})]}),e.jsxs("form",{onSubmit:x=>{x.preventDefault();const j=new FormData(x.currentTarget).get("branch")?.toString().trim()||"";d.submit({branch:j,projectId:o,workspaceId:r})},method:"POST",className:"flex flex-shrink-0 flex-col gap-2",children:[e.jsxs(we,{className:"flex flex-col gap-2",children:[e.jsx(ye,{className:"col-span-4",children:"New branch name:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{required:!0,className:"col-span-3 h-8 w-full flex-1 rounded-sm border border-solid border-[--hl-sm] bg-[--color-bg] py-1 pl-2 pr-7 text-[--color-font] transition-colors placeholder:italic placeholder:opacity-60 focus:outline-none focus:ring-1 focus:ring-[--hl-md]",type:"text",name:"branch",placeholder:"Branch name"}),e.jsxs($,{className:"flex h-8 min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",isDisabled:d.state!=="idle",type:"submit",children:[e.jsx(m,{className:`w-5 ${d.state!=="idle"?"animate-spin":""}`,icon:d.state!=="idle"?"spinner":"plus"})," ","Create"]})]})]}),f&&e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2 rounded border border-solid border-[--hl-md] bg-[rgba(var(--color-warning-rgb),var(--tw-bg-opacity))] bg-opacity-50 p-[--padding-sm] text-[--color-font-warning]",children:e.jsxs("p",{className:"text-base",children:[e.jsx(m,{icon:"exclamation-triangle",className:"mr-2"}),f]})})]}),e.jsxs("div",{className:"flex max-h-96 flex-1 select-none flex-col divide-y divide-solid divide-[--hl-sm] overflow-hidden rounded border border-solid border-[--hl-sm]",children:[e.jsx(O,{className:"p-2 text-sm font-semibold uppercase text-[--hl]",children:"Local Branches"}),e.jsx(X,{"aria-label":"Branches list",selectionMode:"none",items:P.sort(_e).map(x=>({id:x,key:x,name:x,isCurrent:x===s})),className:"flex flex-1 flex-col divide-y divide-solid divide-[--hl-sm] overflow-y-auto focus:outline-none data-[empty]:py-0",children:x=>e.jsx(ee,{id:x.id,textValue:x.name,className:"w-full p-2 transition-colors focus:bg-[--hl-sm] focus:outline-none",children:e.jsx($r,{branch:x.name,isCurrent:x.isCurrent,projectId:o,workspaceId:r,hasUncommittedChanges:g})},x.key)})]}),e.jsxs("div",{className:"flex max-h-96 flex-1 select-none flex-col divide-y divide-solid divide-[--hl-sm] overflow-hidden rounded border border-solid border-[--hl-sm]",children:[e.jsx(O,{className:"p-2 text-sm font-semibold uppercase text-[--hl]",children:"Remote Branches"}),e.jsx(X,{"aria-label":"Remote Branches list",selectionMode:"none",items:M.sort(_e).map(x=>({id:x,key:x,name:x,isCurrent:x===s})),renderEmptyState:()=>e.jsx("div",{className:"p-2 text-center text-[--color-font-disabled]",children:v?"Fetching remote branches...":"No remote branches found"}),className:"flex flex-1 flex-col divide-y divide-solid divide-[--hl-sm] overflow-y-auto focus:outline-none data-[empty]:py-0",children:x=>e.jsx(ee,{id:x.id,textValue:x.name,className:"w-full p-2 transition-colors focus:bg-[--hl-sm] focus:outline-none",children:e.jsx(kr,{branch:x.name,projectId:o,workspaceId:r})},x.key)}),p.length>0&&e.jsx("div",{className:"p-2",children:p.map(x=>e.jsx("div",{className:"p-2",children:x},x))})]})]})})})})},Cr=({onClose:s})=>{const{organizationId:l,projectId:a,workspaceId:t}=q(),o=ar(),r=o.state!=="idle";h.useEffect(()=>{o.state==="idle"&&!o.data&&o.load({projectId:a,workspaceId:t})},[l,a,t,o]);const{log:i}=o.data&&"log"in o.data?o.data:{log:[]};return e.jsx(le,{isOpen:!0,onOpenChange:d=>{!d&&s()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:d=>{!d&&s()},className:"flex max-h-full w-full max-w-4xl flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:d})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(O,{className:"text-2xl",children:"History"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:d,children:e.jsx(m,{icon:"x"})})]}),e.jsx("div",{className:"max-h-96 w-full select-none overflow-y-auto rounded border border-solid border-[--hl-sm]",children:e.jsxs(We,{selectionMode:"multiple",defaultSelectedKeys:"all","aria-label":"Modified objects",className:"w-full border-separate border-spacing-0",children:[e.jsxs(Ve,{children:[e.jsx(K,{isRowHeader:!0,className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Message"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"When"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Author"})]}),e.jsx(Ke,{renderEmptyState:()=>e.jsx("div",{className:"p-2 text-center",children:r?"Loading...":"No history available"}),className:"divide divide-solid divide-[--hl-sm]",items:i.map(p=>({id:p.oid,...p})),children:p=>e.jsxs(Je,{className:"group transition-colors focus-within:bg-[--hl-xxs] focus:outline-none",children:[e.jsx(J,{className:"whitespace-nowrap text-wrap border-b border-solid border-[--hl-sm] p-2 text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("span",{children:p.commit.message})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx(Ye,{className:"no-wrap p-2",timestamp:p.commit.author.timestamp*1e3,intervalSeconds:30})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsxs(z,{children:[e.jsx($,{className:"h-full p-2",children:p.commit.author.name}),e.jsx(U,{placement:"top end",offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:p.commit.author.email})]})})]})})]})})]})})})})},Fr=({onClose:s})=>{const{organizationId:l,projectId:a,workspaceId:t}=q(),o=as(),r=dr(),i=Le(),d=Le(),p=cr();function y({path:j,staged:n}){p.load({filePath:j,projectId:a,staged:n,workspaceId:t})}function u(j){r.submit({projectId:a,workspaceId:t,paths:j})}function P(j){i.submit({projectId:a,workspaceId:t,paths:j})}function M(j,n){T(L,{message:`Are you sure you want to discard ${n===1?"your changes to this file":`your changes to these ${n} files`}? This action cannot be undone and will discard any changes since your last commit.`,title:"Discard changes",okLabel:"Discard",onConfirm:()=>{d.submit({projectId:a,workspaceId:t,paths:j})},addCancel:!0})}h.useEffect(()=>{o.state==="idle"&&!o.data&&o.load({projectId:a,workspaceId:t})},[a,t,o]);const{changes:v}=o.data||{changes:{staged:[],unstaged:[]}},f=ir(),w=f.state!=="idle",g=p.data&&"diff"in p.data?p.data:null,x=[...v.staged,...v.unstaged].length,B=f.data&&"errors"in f.data&&f.data.errors?.length===0;return h.useEffect(()=>{x===0&&B&&s()},[x,s,B]),e.jsx(le,{isOpen:!0,onOpenChange:j=>{!j&&s()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:j=>{!j&&s()},className:"flex h-[calc(100%-var(--padding-xl))] w-[calc(100%-var(--padding-xl))] flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{"data-loading":o.state==="loading"?"true":void 0,className:"flex h-full flex-1 flex-col overflow-hidden outline-none data-[loading]:animate-pulse",children:({close:j})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-2",children:[e.jsx(O,{slot:"title",className:"text-2xl",children:"Commit changes"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:j,children:e.jsx(m,{icon:"x"})})]}),e.jsxs("div",{className:"grid h-full gap-2 divide-x divide-solid divide-[--hl-md] overflow-hidden [grid-template-columns:300px_1fr]",children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("form",{onSubmit:n=>{n.preventDefault();const c=n.nativeEvent instanceof SubmitEvent?n.nativeEvent.submitter:null,k=new FormData(n.currentTarget,c),E=k.get("message")?.toString()||"",S=k.get("push")==="true";f.submit({projectId:a,workspaceId:t,message:E,push:S})},className:"flex flex-col gap-2",children:[e.jsxs(we,{className:"flex flex-shrink-0 flex-col gap-2",children:[e.jsx(ye,{className:"font-bold",children:"Message"}),e.jsx(Qe,{rows:3,name:"message",className:"resize-none rounded-sm border border-solid border-[--hl-sm] p-2 placeholder:text-[--hl-md]",placeholder:"This is a helpful message that describes the changes made in this commit.",required:!0})]}),e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-stretch gap-2",children:[e.jsxs($,{type:"submit",isDisabled:w||v.staged.length===0,formAction:`/organization/${l}/project/${a}/workspace/${t}/git/commit`,className:"flex h-8 flex-1 items-center justify-center gap-2 rounded-sm bg-[--hl-xxs] px-4 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsx(m,{icon:w?"spinner":"check",className:`w-5 ${w?"animate-spin":""}`})," ","Commit"]}),e.jsxs($,{type:"submit",isDisabled:w||v.staged.length===0,name:"push",value:"true",className:"flex h-8 flex-1 items-center justify-center gap-2 rounded-sm bg-[--hl-xxs] px-4 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsx(m,{icon:w?"spinner":"cloud-arrow-up",className:`w-5 ${w?"animate-spin":""}`})," ","Commit and push"]})]}),f.data&&f.data.errors&&f.data.errors.length>0&&e.jsxs("p",{className:"rounded-sm bg-[rgba(var(--color-danger-rgb),var(--tw-bg-opacity))] bg-opacity-20 p-2 text-sm text-[--color-font-danger]",children:[e.jsx(m,{icon:"exclamation-triangle"})," ",f.data.errors.join(`
`),e.jsx(je,{small:!0,...f.data})]})]}),e.jsxs("div",{className:"grid auto-rows-auto gap-2 overflow-y-auto",children:[e.jsxs("div",{className:"flex max-h-96 w-full flex-col gap-2 overflow-hidden",children:[e.jsxs(O,{className:"group flex w-full flex-shrink-0 items-center justify-between gap-2 py-1 font-semibold",children:[e.jsx("span",{className:"flex-1",children:"Staged changes"}),e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-base text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Unstage all changes",onPress:()=>{P(v.staged.map(n=>n.path))},children:e.jsx(m,{icon:"minus","aria-hidden":!0,pointerEvents:"none"})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Unstage all changes"})]}),e.jsx("span",{className:"flex size-6 items-center justify-center rounded-full bg-[--hl-sm] px-1 text-sm text-[--hl]",children:v.staged.length})]}),e.jsx("div",{className:"flex w-full flex-1 select-none overflow-y-auto",children:e.jsx(X,{className:"w-full",items:v.staged.map(n=>({entry:n,id:n.path,textValue:n.path})),"aria-label":"Unstaged changes",onAction:n=>{y({path:n.toString(),staged:!0})},renderEmptyState:()=>e.jsx("p",{className:"p-2 text-sm text-[--hl]",children:"Stage your changes to commit them."}),children:n=>e.jsxs(ee,{className:"group flex w-full select-none items-center justify-between overflow-hidden px-2 py-1 text-[--hl] outline-none transition-colors hover:bg-[--hl-xs] focus:bg-[--hl-sm] aria-selected:bg-[--hl-sm] aria-selected:text-[--color-font]",children:[e.jsx("span",{className:"truncate",children:n.entry.name}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Unstage change",onPress:()=>{P([n.entry.path])},children:e.jsx(m,{icon:"minus","aria-hidden":!0,pointerEvents:"none"})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Unstage change"})]})})]})})})]}),e.jsxs("div",{className:"flex max-h-96 w-full flex-col gap-2 overflow-hidden",children:[e.jsxs(O,{className:"group flex w-full flex-shrink-0 items-center justify-between py-1 font-semibold",children:[e.jsx("span",{children:"Changes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-base text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Discard all changes",onPress:()=>{M(v.unstaged.map(n=>n.path),v.unstaged.length)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-4",children:e.jsx("path",{d:"M5.828 7l2.536 2.535L6.95 10.95 2 6l4.95-4.95 1.414 1.415L5.828 5H13a8 8 0 110 16H4v-2h9a6 6 0 000-12H5.828z"})})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Discard all changes"})]}),e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center gap-2 rounded-sm px-2 text-base text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Stage all changes",onPress:()=>{u(v.unstaged.map(n=>n.path))},children:e.jsx(m,{icon:"plus","aria-hidden":!0,pointerEvents:"none"})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Stage all changes"})]}),e.jsx("span",{className:"flex size-6 items-center justify-center rounded-full bg-[--hl-sm] px-1 text-sm text-[--hl]",children:v.unstaged.length})]})]}),e.jsx("div",{className:"flex w-full flex-1 select-none overflow-y-auto",children:e.jsx(X,{className:"w-full",items:v.unstaged.map(n=>({entry:n,id:n.path,key:n.path,textValue:n.path})),"aria-label":"Unstaged changes",onAction:n=>{y({path:n.toString(),staged:!1})},children:n=>e.jsxs(ee,{className:"group flex w-full select-none items-center justify-between overflow-hidden px-2 py-1 text-[--hl] outline-none transition-colors hover:bg-[--hl-xs] focus:bg-[--hl-sm] aria-selected:bg-[--hl-sm] aria-selected:text-[--color-font]",children:[e.jsx("span",{className:"truncate",children:n.entry.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Discard change",onPress:()=>{M([n.entry.path],1)},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-4",children:e.jsx("path",{d:"M5.828 7l2.536 2.535L6.95 10.95 2 6l4.95-4.95 1.414 1.415L5.828 5H13a8 8 0 110 16H4v-2h9a6 6 0 000-12H5.828z"})})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Discard change"})]}),e.jsxs(z,{children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,name:"Stage change",onPress:()=>{u([n.entry.path])},children:e.jsx(m,{icon:"plus","aria-hidden":!0,pointerEvents:"none"})}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"Stage change"})]})]})]})})})]})]})]}),g?.diff?e.jsxs("div",{className:"flex h-full flex-col gap-2 overflow-y-auto p-2 pb-0",children:[e.jsxs(O,{className:"flex items-center gap-2 font-bold",children:[e.jsx(m,{icon:"code-compare"}),g.name]}),g&&e.jsx("div",{className:"flex-1 overflow-y-auto rounded-sm bg-[--hl-xs] p-2 text-[--color-font]",children:e.jsx(Ze,{original:g.diff.before,modified:g.diff.after})})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-4 p-2",children:[e.jsxs(O,{className:"flex items-center justify-center gap-2 text-4xl font-semibold text-[--hl-md]",children:[e.jsx(m,{icon:"code-compare"}),"Diff view"]}),e.jsx("p",{className:"text-[--hl]",children:"Select an item to compare"})]})]})]})})})})},Pr=({gitRepository:s,isInsomniaSyncEnabled:l,showDeprecatedWarning:a})=>{const{organizationId:t,projectId:o,workspaceId:r}=q(),[i,d]=h.useState(!1),[p,y]=h.useState(!1),[u,P]=h.useState(!1),[M,v]=h.useState(!1),f=Qt(),w=Be(),g=Zt(),N=Yt(),x=Xt(),B=rs(),j=f.state==="loading",n=N.state==="loading",c=x.state==="loading",[k,E]=h.useState(!1);h.useEffect(()=>{s?.uri&&s?._id&&g.state==="idle"&&!g.data&&g.load({projectId:o,workspaceId:r})},[g,s?.uri,s?._id,t,o,r]);const S=!!(s?.uri&&s?._id&&x.state==="idle"&&!x.data&&g.data);h.useEffect(()=>{S&&x.submit({projectId:o,workspaceId:r})},[x,t,o,S,r]),h.useEffect(()=>{const b=[...f.data?.errors??[]];b.length>0&&T(L,{title:"Push Failed",message:e.jsxs(e.Fragment,{children:[b.join(`
`),e.jsx(je,{...f.data})]})})},[f.data]),h.useEffect(()=>{const H=[...g.data&&"errors"in g.data&&g.data.errors?g.data.errors:[]];if(H.length>0){if(i)return;T(L,{title:"Loading of Git Repository Failed",message:H.join(`
`)})}},[i,g.data]),h.useEffect(()=>{const b=[...w.data?.errors??[]];b.length>0&&T(L,{title:"Checkout Failed",message:b.join(`
`)})},[w.data?.errors]);async function I({force:b}){f.submit({projectId:o,workspaceId:r,force:b})}let se=["fab","git-alt"];const de=vt(s?.credentials);de==="github"&&(se=["fab","github"]),de==="gitlab"&&(se=["fab","gitlab"]);const D=g.state==="loading"||N.state==="loading"||w.state==="loading"||f.state==="loading"||k,G=!!(s?.uri&&g.data&&!("errors"in g.data)),{branches:C,branch:A}=g.data&&"branches"in g.data?g.data:{branches:[],branch:""},{revalidate:W}=ts(),me=G?[{id:"commit",icon:"check",isDisabled:!1,label:"Commit",action:()=>v(!0)},{id:"pull",icon:k?"refresh":"cloud-download",label:"Pull",isDisabled:!1,action:async()=>{try{E(!0),await window.main.git.pullFromGitRemote({projectId:o,workspaceId:r}).then(b=>{"errors"in b&&b.errors&&T(L,{title:"Pull Failed",message:e.jsxs(e.Fragment,{children:[b.errors.join(`
`),e.jsx(je,{gitRepository:s,errors:[b.errors.join(`
`)]})]}),bodyClassName:"whitespace-break-spaces"}),"conflicts"in b&&T(qe,{conflicts:b.conflicts,labels:b.labels,onResolveAll:H=>{E(!0),window.main.git.continueMerge({projectId:o,workspaceId:r,handledMergeConflicts:H,commitMessage:b.commitMessage,commitParent:b.commitParent}).finally(()=>{E(!1),W()})}})}).finally(()=>{E(!1),W()})}catch(b){const H=b instanceof Error?b.message:"An error occurred while pulling";T(L,{title:"Pull Failed",message:e.jsxs(e.Fragment,{children:[H,e.jsx(je,{gitRepository:s,errors:[H]})]}),bodyClassName:"whitespace-break-spaces"})}}},{id:"push",icon:j?"refresh":"cloud-upload",label:"Push",isDisabled:!1,action:()=>I({force:!1})},{id:"history",icon:"clock",isDisabled:!1,label:"History",action:()=>P(!0)},{id:"fetch",icon:"refresh",isDisabled:!1,label:"Fetch",action:()=>{N.submit({projectId:o,workspaceId:r})}}]:[],V=G?[{id:"repository-settings",label:"Repository Settings",isDisabled:!1,icon:"wrench",action:()=>d(!0)},{id:"branches",label:"Branches",isDisabled:!1,icon:"code-branch",action:()=>y(!0)}]:[{id:"connect",label:"Connect Repository",icon:"plug",isDisabled:!1,action:()=>d(!0)}];Xe(()=>{N.submit({projectId:o,workspaceId:r})},1e3*60*5);const te=x.data?.status,ue=te?.localChanges?"Local changes made":"No local changes made",re=l?[{id:"switch-to-git-repo",label:"Switch to Insomnia Sync",icon:"cloud",action:async()=>{B.submit({projectId:o,workspaceId:r})}}]:[],ae=G&&C?C.map(b=>({id:b,label:b,isActive:b===A,icon:"code-branch",action:async()=>{w.submit({projectId:o,workspaceId:r,branch:b})}})):[],fe=[...re,...V,...ae,...me];return e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"p-[--padding-sm]",children:e.jsx("div",{className:"flex flex-wrap items-center justify-between gap-2 rounded border border-solid border-[--hl-md] bg-[rgba(var(--color-warning-rgb),var(--tw-bg-opacity))] bg-opacity-50 p-[--padding-xs] text-[--color-font-warning]",children:e.jsxs("p",{className:"text-sm",children:[e.jsx(m,{icon:"exclamation-triangle",className:"mr-2"}),"You are using the legacy Git integration in this project, learn more about converting to the new Git Sync capability."," ",e.jsx($,{className:"underline",onPress:()=>window.main.openInBrowser("https://docs.insomnia.rest/insomnia/git-sync"),children:"Migration Guide"})]})})}),e.jsxs(Fe,{children:[e.jsxs("div",{className:"flex h-[--line-height-sm] w-full items-center text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsxs($,{"data-testid":"git-dropdown","aria-label":"Git Sync",className:"flex h-full flex-1 items-center gap-2 truncate px-[--padding-md]",children:[e.jsx(m,{icon:D?"refresh":se,className:`w-5 ${D?"animate-spin":""}`}),e.jsx("span",{className:"truncate",children:G?A:"Not synced"})]}),e.jsxs(z,{children:[e.jsx($,{className:`h-full px-[--padding-md] ${te?.localChanges?"text-[--color-warning]":""}`,children:e.jsx(m,{icon:c?"refresh":"cube",className:`transition-colors ${D?"animate-pulse":c?"animate-spin":""}`})}),e.jsx(U,{placement:"top end",offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:ue})]})]}),e.jsx(Pe,{className:"min-w-max max-w-lg overflow-hidden",placement:"top end",offset:8,children:e.jsxs(De,{"aria-label":"Git Sync Menu",selectionMode:"single",disabledKeys:fe.filter(b=>b?.isDisabled).map(b=>b.id),onAction:b=>{fe.find(pe=>pe.id===b)?.action()},className:"max-h-[85vh] max-w-lg select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-2 text-sm shadow-lg focus:outline-none",children:[e.jsx(Q,{className:"border-b border-solid border-[--hl-sm] pb-2 empty:border-none empty:pb-0",children:e.jsx(Y,{items:re,children:b=>e.jsx(Z,{textValue:b.label,className:"group flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold","aria-label":b.label,children:e.jsxs("div",{className:"group-pressed:opacity-80 flex w-full items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] bg-[rgba(var(--color-surprise-rgb),var(--tw-bg-opacity))] bg-opacity-100 px-4 py-1 text-sm font-semibold text-[--color-font-surprise] ring-1 ring-transparent transition-all hover:bg-opacity-80 focus:ring-inset focus:ring-[--hl-md] group-hover:bg-opacity-80 group-hover:ring-inset group-focus:bg-opacity-80 group-focus:ring-inset aria-pressed:opacity-80",children:[e.jsx(m,{icon:b.icon}),e.jsx("div",{children:b.label})]})})})}),e.jsx(Q,{className:"border-b border-solid border-[--hl-sm] pb-2 empty:border-none empty:pb-0",children:e.jsx(Y,{items:V,children:b=>e.jsxs(Z,{className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold","aria-label":b.label,children:[e.jsx(m,{icon:b.icon}),e.jsx("span",{children:b.label})]})})}),e.jsx(Q,{className:"border-b border-solid border-[--hl-sm] pb-2 empty:border-none empty:pb-0",children:e.jsx(Y,{items:ae,children:b=>e.jsxs(Z,{className:`flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold ${b.isActive?"font-bold":""}`,"aria-label":b.label,children:[e.jsx(m,{icon:b.icon,className:b.isActive?"text-[--color-success]":""}),e.jsx("span",{className:"truncate",children:b.label})]})})}),e.jsx(Q,{children:e.jsx(Y,{items:me,children:b=>e.jsxs(Z,{className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold","aria-label":b.label,children:[e.jsx(m,{icon:b.icon}),e.jsx("span",{children:b.label})]})})})]})})]}),i&&e.jsx(Us,{gitRepository:s??void 0,onHide:()=>d(!1)}),p&&s&&e.jsx(Sr,{onClose:()=>y(!1),currentBranch:A??"",branches:C??[]}),u&&s&&e.jsx(Cr,{onClose:()=>P(!1)}),M&&s&&e.jsx(Fr,{onClose:()=>v(!1)})]})},Dr=({branch:s,isCurrent:l,organizationId:a,projectId:t,workspaceId:o})=>{const r=os(),i=xr(),d=ns();return h.useEffect(()=>{if(r.data&&"error"in r.data&&r.data.error&&r.state==="idle"){const p=r.data.error||"An unexpected error occurred while checking out the branch.";T(L,{title:"Error while checking out branch.",message:p})}},[r.data,r.state]),h.useEffect(()=>{if(i.data&&"error"in i.data&&i.data.error&&i.state==="idle"){const p=i.data.error||"An unexpected error occurred while merging the branches.";T(L,{title:"Error while merging branches.",message:p})}},[i.data,i.state]),h.useEffect(()=>{if(d.data&&"error"in d.data&&d.data.error&&d.state==="idle"){const p=d.data.error||"An unexpected error occurred while deleting the branch.";T(L,{title:"Error while deleting branch",message:p})}},[d.data,d.state]),e.jsxs("div",{className:"flex w-full items-center",children:[e.jsx("span",{className:"flex-1 truncate",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[s!=="master"&&e.jsxs(he,{confirmMessage:"Confirm",className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",doneMessage:"Deleted",disabled:l||s==="master",onClick:()=>d.submit({organizationId:a,projectId:t,workspaceId:o,branch:s}),children:[e.jsx(m,{icon:d.state!=="idle"?"spinner":"trash",className:`w-5 text-[--color-danger] ${d.state!=="idle"?"animate-spin":""}`}),"Delete"]}),e.jsxs($,{className:"flex items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",isDisabled:l,onPress:()=>r.submit({organizationId:a,projectId:t,workspaceId:o,branch:s}),children:[e.jsx(m,{icon:r.state!=="idle"?"spinner":"turn-up",className:`w-5 ${r.state!=="idle"?"animate-spin":"rotate-90"}`}),"Checkout"]}),e.jsxs(he,{className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",doneMessage:"Merged",confirmMessage:"Confirm",disabled:l,onClick:()=>{i.submit({organizationId:a,projectId:t,workspaceId:o,branch:s})},children:[e.jsx(m,{icon:i.state!=="idle"?"spinner":"code-merge",className:`w-5 ${i.state!=="idle"?"animate-spin":""}`}),"Merge"]})]})]})},Mr=({branch:s,isCurrent:l,organizationId:a,projectId:t,workspaceId:o})=>{const r=ns(),i=pr();return h.useEffect(()=>{if(i.data&&"error"in i.data&&i.data.error&&i.state==="idle"){const d=i.data.error||"An unexpected error occurred while pulling the branch.";T(L,{title:"Error while pulling branch.",message:d})}},[i.data,i.state]),h.useEffect(()=>{if(r.data&&"error"in r.data&&r.data.error&&r.state==="idle"){const d=r.data.error||"An unexpected error occurred while deleting the branch.";T(L,{title:"Error while deleting branch.",message:d})}},[r.data,r.state]),e.jsxs("div",{className:"flex w-full items-center",children:[e.jsx("span",{className:"flex-1 truncate",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[s!=="master"&&e.jsxs(he,{confirmMessage:"Confirm",className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",doneMessage:"Deleted",disabled:l||s==="master",onClick:()=>r.submit({organizationId:a,projectId:t,workspaceId:o,branch:s}),children:[e.jsx(m,{icon:r.state!=="idle"?"spinner":"trash",className:`w-5 text-[--color-danger] ${r.state!=="idle"?"animate-spin":""}`}),"Delete"]}),e.jsxs($,{className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:()=>i.submit({organizationId:a,projectId:t,workspaceId:o,branch:s}),children:[e.jsx(m,{icon:i.state!=="idle"?"spinner":"cloud-arrow-down",className:`w-5 ${i.state!=="idle"?"animate-spin":""}`}),"Fetch"]})]})]})},Br=({onClose:s,branches:l,remoteBranches:a,currentBranch:t})=>{const{organizationId:o,projectId:r,workspaceId:i}=q(),d=fr();function p(y,u){return y==="master"?-1:u==="master"?1:y.localeCompare(u)}return e.jsx(le,{isOpen:!0,onOpenChange:y=>{!y&&s()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:y=>{!y&&s()},className:"flex max-h-full w-full max-w-4xl flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:y})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-2",children:[e.jsx(O,{slot:"title",className:"text-2xl",children:"Branches"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:y,children:e.jsx(m,{icon:"x"})})]}),e.jsx(d.Form,{action:ss("/organization/:organizationId/project/:projectId/workspace/:workspaceId/insomnia-sync/branch/create",{organizationId:o,projectId:r,workspaceId:i}),method:"POST",className:"flex flex-shrink-0 flex-col gap-2",children:e.jsxs(we,{className:"flex flex-col gap-2",children:[e.jsx(ye,{className:"col-span-4",children:"New branch name:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{required:!0,className:"col-span-3 h-8 w-full flex-1 rounded-sm border border-solid border-[--hl-sm] bg-[--color-bg] py-1 pl-2 pr-7 text-[--color-font] transition-colors placeholder:italic placeholder:opacity-60 focus:outline-none focus:ring-1 focus:ring-[--hl-md]",type:"text",name:"branchName",placeholder:"Branch name"}),e.jsxs($,{className:"flex h-8 min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",isDisabled:d.state!=="idle",type:"submit",children:[e.jsx(m,{className:`w-5 ${d.state!=="idle"?"animate-spin":""}`,icon:d.state!=="idle"?"spinner":"plus"})," ","Create"]})]})]})}),d.data?.error&&e.jsxs("div",{className:"flex flex-shrink-0 items-center gap-2",children:[e.jsx(m,{icon:"triangle-exclamation",className:"w-5 text-[--color-danger]"}),e.jsx("span",{className:"text-sm text-[--color-danger]",children:d.data.error})]}),e.jsxs("div",{className:"flex max-h-96 flex-1 select-none flex-col divide-y divide-solid divide-[--hl-sm] overflow-hidden rounded border border-solid border-[--hl-sm]",children:[e.jsx(O,{className:"p-2 text-sm font-semibold uppercase text-[--hl]",children:"Local Branches"}),e.jsx(X,{"aria-label":"Branches list",selectionMode:"none",items:l.sort(p).map(u=>({id:u,key:u,name:u,isCurrent:u===t})),className:"flex flex-1 flex-col divide-y divide-solid divide-[--hl-sm] overflow-y-auto focus:outline-none data-[empty]:py-0",children:u=>e.jsx(ee,{id:u.id,textValue:u.name,className:"w-full p-2 transition-colors focus:bg-[--hl-sm] focus:outline-none",children:e.jsx(Dr,{branch:u.name,isCurrent:u.isCurrent,organizationId:o,projectId:r,workspaceId:i})},u.key)})]}),a.length>0&&e.jsxs("div",{className:"flex max-h-96 flex-1 select-none flex-col divide-y divide-solid divide-[--hl-sm] overflow-hidden rounded border border-solid border-[--hl-sm]",children:[e.jsx(O,{className:"p-2 text-sm font-semibold uppercase text-[--hl]",children:"Remote Branches"}),e.jsx(X,{"aria-label":"Remote Branches list",selectionMode:"none",items:a.sort(p).map(u=>({id:u,key:u,name:u,isCurrent:u===t})),className:"flex flex-1 flex-col divide-y divide-solid divide-[--hl-sm] overflow-y-auto focus:outline-none data-[empty]:py-0",children:u=>e.jsx(ee,{id:u.id,textValue:u.name,className:"w-full p-2 transition-colors focus:bg-[--hl-sm] focus:outline-none",children:e.jsx(Mr,{branch:u.name,isCurrent:u.isCurrent,organizationId:o,projectId:r,workspaceId:i})},u.key)})]})]})})})})},Er=({snapshot:s})=>{const{projectId:l,workspaceId:a,organizationId:t}=q(),o=gr();return e.jsx(he,{className:"flex min-w-[12ch] items-center justify-center gap-2 rounded-sm border border-solid border-[--hl-md] px-4 py-1 text-sm font-semibold text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",confirmMessage:"Confirm",onClick:()=>{o.submit({organizationId:t,projectId:l,workspaceId:a,id:s.id})},children:"Restore"})},Ar=({history:s,onClose:l})=>{const{userSession:a}=es(),t=o=>{let r="";if(o.authorAccount){const{firstName:i,lastName:d}=o.authorAccount;r+=`${i} ${d}`}return o.author===a.accountId&&(r+=" (you)"),r};return e.jsx(le,{isOpen:!0,onOpenChange:o=>{!o&&l()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:o=>{!o&&l()},className:"flex max-h-full w-full max-w-4xl flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:o})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(O,{className:"text-2xl",children:"History"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:o,children:e.jsx(m,{icon:"x"})})]}),e.jsx("div",{className:"max-h-96 w-full select-none overflow-y-auto rounded border border-solid border-[--hl-sm]",children:e.jsxs(We,{selectionMode:"multiple",defaultSelectedKeys:"all","aria-label":"Modified objects",className:"w-full border-separate border-spacing-0",children:[e.jsxs(Ve,{children:[e.jsx(K,{isRowHeader:!0,className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Message"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"When"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Author"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Objects"}),e.jsx(K,{className:"sticky top-0 z-10 border-b border-[--hl-sm] bg-[--hl-xs] px-2 py-2 text-left text-xs font-semibold backdrop-blur backdrop-filter focus:outline-none",children:"Restore"})]}),e.jsx(Ke,{className:"divide divide-solid divide-[--hl-sm]",items:s,children:r=>e.jsxs(Je,{className:"group transition-colors focus-within:bg-[--hl-xxs] focus:outline-none",children:[e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("span",{className:"p-2",children:r.name})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx(Ye,{className:"no-wrap p-2",timestamp:r.created,intervalSeconds:30})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("div",{className:"p-2",children:t(r)?e.jsxs(e.Fragment,{children:[t(r)," ",e.jsx(Ie,{info:!0,delay:500,children:r.authorAccount?.email||""})]}):"--"})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("span",{className:"p-2",children:r.state.length})}),e.jsx(J,{className:"whitespace-nowrap border-b border-solid border-[--hl-sm] text-sm font-medium focus:outline-none group-last-of-type:border-none",children:e.jsx("div",{className:"p-2",children:e.jsx(Er,{snapshot:r})})})]})})]})})]})})})})};function Or(s){let l="{}",a="{}";s&&"previousBlobContent"in s&&s.previousBlobContent&&(s.previousBlobContent==="null"?l="":l=s.previousBlobContent||"{}"),s&&"blobContent"in s&&s.blobContent&&(s.blobContent==="null"?a="":a=s.blobContent||"{}");try{l=Ge(JSON.parse(l))}catch(t){console.warn("Failed to parse before JSON",t)}try{a=Ge(JSON.parse(a))}catch(t){console.warn("Failed to parse after JSON",t)}return{before:l,after:a}}function Tr(s){return s?"name"in s&&s.name?s.name:"document"in s&&s.document&&"type"in s.document?s.document?.type:"Diff view":"Diff view"}function Re(s){const l=s.split("_")[0];return zt().find(t=>t.prefix===l)?.name||"Unknown"}const Lr=({onClose:s,status:l,syncItems:a})=>{const{projectId:t,workspaceId:o,organizationId:r}=q(),i=Object.entries(l.stage).map(([j,n])=>({...n,document:a.find(c=>c.key===j)?.document||"deleted"in n?{type:Re(j)}:void 0,id:`staged-${j}`})),d=Object.entries(l.unstaged).map(([j,n])=>({...n,document:a.find(c=>c.key===j)?.document||"deleted"in n?{type:Re(j)}:void 0,id:`unstaged-${j}`})),p=jr(),y=wr(),u=j=>{p.submit({organizationId:r,projectId:t,workspaceId:o,keys:j})},P=j=>{y.submit({keys:j,organizationId:r,projectId:t,workspaceId:o})},M=[...i,...d],v=M.length,f=br();h.useEffect(()=>{v===0&&!f.data?.error&&s()},[v,s,f.data?.error]);const[w,g]=h.useState(""),N=M.find(j=>j.id===w),x=Tr(N),B=Or(N);return e.jsx(le,{isOpen:!0,onOpenChange:j=>{!j&&s()},isDismissable:!0,className:"fixed left-0 top-0 z-10 flex h-[--visual-viewport-height] w-full items-center justify-center bg-black/30",children:e.jsx(ie,{onOpenChange:j=>{!j&&s()},className:"flex h-[calc(100%-var(--padding-xl))] w-[calc(100%-var(--padding-xl))] flex-col rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] p-[--padding-lg] text-[--color-font]",children:e.jsx(ce,{className:"flex h-full flex-1 flex-col overflow-hidden outline-none",children:({close:j})=>e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-2",children:[e.jsx(O,{slot:"title",className:"text-2xl",children:"Commit changes"}),e.jsx($,{className:"flex aspect-square h-6 flex-shrink-0 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",onPress:j,children:e.jsx(m,{icon:"x"})})]}),e.jsxs("div",{className:"grid h-full gap-2 divide-x divide-solid divide-[--hl-md] overflow-hidden [grid-template-columns:300px_1fr]",children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-4 overflow-hidden",children:[e.jsxs("form",{onSubmit:n=>{n.preventDefault();const c=n.nativeEvent instanceof SubmitEvent?n.nativeEvent.submitter:null,k=new FormData(n.currentTarget,c),E=k.get("message")?.toString().trim()||"",S=k.get("push")==="true";E&&f.submit({organizationId:r,projectId:t,workspaceId:o,message:E,push:S})},className:"flex flex-col gap-2",children:[e.jsxs(we,{className:"flex flex-shrink-0 flex-col gap-2",children:[e.jsx(ye,{className:"font-bold",children:"Message"}),e.jsx(Qe,{rows:3,name:"message",className:"resize-none rounded-sm border border-solid border-[--hl-sm] p-2 placeholder:text-[--hl-md]",placeholder:"This is a helpful message that describes the changes made in this commit.",required:!0})]}),e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-stretch gap-2",children:[e.jsxs($,{type:"submit",isDisabled:f.state!=="idle",formAction:`/organization/${r}/project/${t}/workspace/${o}/insomnia-sync/branch/create-snapshot`,className:"flex h-8 flex-1 items-center justify-center gap-2 rounded-sm bg-[--hl-xxs] px-4 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsx(m,{icon:f.state!=="idle"?"spinner":"check",className:`w-5 ${f.state==="idle"?"":"animate-spin"}`})," ","Commit"]}),e.jsxs($,{type:"submit",isDisabled:f.state!=="idle",name:"push",value:"true",className:"flex h-8 flex-1 items-center justify-center gap-2 rounded-sm bg-[--hl-xxs] px-4 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm]",children:[e.jsx(m,{icon:f.state!=="idle"?"spinner":"cloud-arrow-up",className:`w-5 ${f.state!=="idle"?"animate-spin":""}`})," ","Commit and push"]})]}),f.data?.error&&e.jsxs("p",{className:"rounded-sm bg-[rgba(var(--color-danger-rgb),var(--tw-bg-opacity))] bg-opacity-20 p-2 text-sm text-[--color-font-danger]",children:[e.jsx(m,{icon:"exclamation-triangle"})," ",f.data.error]})]}),e.jsxs("div",{className:"grid auto-rows-auto gap-2 overflow-y-auto",children:[e.jsxs("div",{className:"flex max-h-96 w-full flex-col gap-2 overflow-hidden",children:[e.jsxs(O,{className:"group flex w-full flex-shrink-0 items-center justify-between gap-2 py-1 font-semibold",children:[e.jsx("span",{className:"flex-1",children:"Staged changes"}),e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,onPress:()=>{P(i.map(n=>n.key))},children:e.jsx(m,{icon:"minus"})}),e.jsx("span",{className:"rounded-full bg-[--hl-sm] px-1 text-xs text-[--hl]",children:i.length})]}),e.jsx("div",{className:"flex w-full flex-1 select-none overflow-y-auto",children:e.jsx(X,{className:"w-full",items:i.map(n=>({entry:n,id:n.id,key:n.id,textValue:n.name||n.document?.type||""})),"aria-label":"Unstaged changes",onAction:n=>{g(n.toString())},renderEmptyState:()=>e.jsx("p",{className:"p-2 text-sm text-[--hl]",children:"Stage your changes to commit them."}),children:n=>e.jsxs(ee,{className:"group flex w-full select-none items-center justify-between overflow-hidden px-2 py-1 text-[--hl] outline-none transition-colors hover:bg-[--hl-xs] focus:bg-[--hl-sm] aria-selected:bg-[--hl-sm] aria-selected:text-[--color-font]",children:[e.jsx("span",{className:"truncate",children:n.entry.name||n.entry.document?.type}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,onPress:()=>{P([n.entry.key])},children:e.jsx(m,{icon:"minus"})}),e.jsxs(z,{children:[e.jsx($,{className:"cursor-default",children:"added"in n.entry?"U":"deleted"in n.entry?"D":"M"}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"added"in n.entry?"Untracked":"deleted"in n.entry?"Deleted":"Modified"})]})]})]})})})]}),e.jsxs("div",{className:"flex max-h-96 w-full flex-col gap-2 overflow-hidden",children:[e.jsxs(O,{className:"group flex w-full flex-shrink-0 items-center justify-between py-1 font-semibold",children:[e.jsx("span",{children:"Changes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,onPress:()=>{u(d.map(n=>n.key))},children:e.jsx(m,{icon:"plus"})}),e.jsx("span",{className:"rounded-full bg-[--hl-sm] px-1 text-xs text-[--hl]",children:d.length})]})]}),e.jsx("div",{className:"flex w-full flex-1 select-none overflow-y-auto",children:e.jsx(X,{className:"w-full",items:d.map(n=>({entry:n,id:n.id,key:n.id,textValue:n.name||n.document?.type||""})),"aria-label":"Unstaged changes",onAction:n=>{g(n.toString())},children:n=>e.jsxs(ee,{className:"group flex w-full select-none items-center justify-between overflow-hidden px-2 py-1 text-[--hl] outline-none transition-colors hover:bg-[--hl-xs] focus:bg-[--hl-sm] aria-selected:bg-[--hl-sm] aria-selected:text-[--color-font]",children:[e.jsx("span",{className:"truncate",children:n.entry.name||n.entry.document?.type}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-focus-within:opacity-100 group-hover:opacity-100 group-focus:opacity-100 aria-pressed:bg-[--hl-sm] data-[pressed]:opacity-100",slot:null,onPress:()=>{u([n.entry.key])},children:e.jsx(m,{icon:"plus"})}),e.jsxs(z,{children:[e.jsx($,{className:"cursor-default",children:"added"in n.entry?"U":"deleted"in n.entry?"D":"M"}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:"added"in n.entry?"Untracked":"deleted"in n.entry?"Deleted":"Modified"})]})]})]})})})]})]})]}),N?e.jsxs("div",{className:"flex h-full flex-col gap-2 overflow-y-auto p-2 pb-0",children:[e.jsxs(O,{className:"flex items-center gap-2 font-bold",children:[e.jsx(m,{icon:"code-compare"}),x]}),N&&e.jsx("div",{className:"flex-1 overflow-y-auto rounded-sm bg-[--hl-xs] p-2 text-[--color-font]",children:e.jsx(Ze,{original:B.before,modified:B.after})})]}):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-4 p-2",children:[e.jsxs(O,{className:"flex items-center justify-center gap-2 text-4xl font-semibold text-[--hl-md]",children:[e.jsx(m,{icon:"code-compare"}),"Diff view"]}),e.jsx("p",{className:"text-[--hl]",children:"Select an item to compare"})]})]})]})})})})},Gr=1e3*60,R="earth-americas",_r=()=>{const{organizationId:s,projectId:l,workspaceId:a}=q(),[t,o]=h.useState(!1),[r,i]=h.useState(!1),[d,p]=h.useState(!1),[y,u]=h.useState(!1),[P,M]=h.useState(!0),[v,f]=h.useState(null),w=ur(),g=mr(),N=hr(),x=os(),B=Nt(),j=$t();h.useEffect(()=>{B.state==="idle"&&!B.data&&B.load({organizationId:s,projectId:l,workspaceId:a})},[s,l,B,a]);const n=h.useCallback(()=>{const F=j.submit;F({organizationId:s,projectId:l,workspaceId:a})},[s,l,j.submit,a]);h.useEffect(()=>{const F=window.main.on("mainWindowFocusChange",(qs,ge)=>{M(ge),ge&&n()});return()=>{F()}},[n]),h.useEffect(()=>{x.data&&"error"in x.data&&x.data.error?(f(x.data.error),_({icon:R,title:"Checkout failed",status:"error"})):x.data&&"success"in x.data&&x.data.success&&_({icon:R,title:"Checkout completed",status:"success"})},[x.data]),h.useEffect(()=>{w.data&&"error"in w.data&&w.data.error?(f(w.data.error),_({icon:R,title:"Push failed"})):w.data&&"success"in w.data&&w.data.success&&_({icon:R,title:"Push completed",status:"success"})},[w.data]),h.useEffect(()=>{g.data&&"error"in g.data&&g.data.error?(f(g.data.error),_({icon:R,title:"Pull failed"})):g.data&&"success"in g.data&&g.data.success&&_({icon:R,title:"Pull completed",status:"success"})},[g.data]),h.useEffect(()=>{N.data&&"error"in N.data&&N.data.error?(f(N.data.error),_({icon:R,title:"Rollback failed",status:"error"})):N.data&&"success"in N.data&&N.data.success&&_({icon:R,title:"Rollback completed",status:"success"})},[N.data]),Xe(()=>{n()},P?Gr:null);const{status:c,localBranches:k=[],remoteBranches:E=[],currentBranch:S="",historyCount:I=0,history:se=[],syncItems:de=[],compare:D={ahead:0,behind:0}}=B.data||{status:{stage:{},unstaged:{},key:""},localBranches:[],remoteBranches:[],currentBranch:"",historyCount:0,history:[],syncItems:[],compare:{ahead:0,behind:0}},G=Object.keys(c?.stage||{}).length>0||Object.keys(c?.unstaged||{}).length>0,C=D?.behind||0,A=D?.ahead||0,W=D?.ahead&&D.ahead>0,V=D?.behind&&D.behind>0?`There ${D.behind===1?"is":"are"} ${D.behind} commit${D.behind===1?"":"s"} to pull`:"No changes to pull",te=W?`There ${D.ahead===1?"is":"are"} ${D.ahead} commit${D.ahead===1?"":"s"} to push`:"No changes to push",ue=k.map(F=>({id:`checkout-${F}`,name:F,icon:"code-branch",isActive:F===S,action:()=>{f(null),_({icon:R,title:`Checking out branch ${F}`}),x.submit({organizationId:s,projectId:l,workspaceId:a,branch:F})}})),re=[{id:"branches",name:"Branches",icon:"code-fork",action:()=>u(!0)},{id:"history",name:"History",icon:"clock",isDisabled:I===0,action:()=>i(!0)},{id:"revert",name:"Discard all changes",icon:"undo",isDisabled:I===0||N.state!=="idle"||!G,action:()=>{f(null),_({icon:R,title:"Rollback started"}),N.submit({organizationId:s,projectId:l,workspaceId:a})}},{id:"commit",name:"Commit",icon:"cube",isDisabled:!G||N.state!=="idle",action:()=>p(!0)},{id:"pull",name:g.state!=="idle"?"Pulling...":D.behind>0?`Pull ${D.behind||""} Commit${D.behind===1?"":"s"}`:"Pull",icon:g.state!=="idle"?"refresh":"cloud-download",isDisabled:D.behind===0||g.state!=="idle",action:()=>{f(null),_({icon:R,title:"Pull failed",status:"error"}),g.submit({organizationId:s,projectId:l,workspaceId:a})}},{id:"push",name:w.state!=="idle"?"Pushing...":D.ahead>0?`Push ${D.ahead||""} Commit${D.ahead===1?"":"s"}`:"Push",icon:w.state!=="idle"?"refresh":"cloud-upload",isDisabled:D.ahead===0||w.state!=="idle",action:()=>{f(null),_({icon:R,title:"Push started"}),w.submit({organizationId:s,projectId:l,workspaceId:a})}}],ae=g.state!=="idle",fe=w.state!=="idle",b=N.state!=="idle",H=x.state!=="idle",pe=b||H,Ee=[...ue,...re],oe=B.data&&"error"in B.data?B.data.error:null,Hs=pe||ae||fe;return e.jsxs(h.Fragment,{children:[v&&e.jsxs("div",{className:"flex gap-2 bg-[rgba(var(--color-danger-rgb),1)] px-2 py-1 text-xs text-[--color-font-danger]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{icon:"triangle-exclamation"}),e.jsx("span",{children:v})]}),e.jsx($,{onPress:()=>f(null),className:"ml-auto",children:e.jsx(m,{icon:"xmark",className:"mt-0.5"})})]}),e.jsxs(Fe,{children:[e.jsxs(z,{delay:0,children:[e.jsxs($,{isDisabled:Hs,"data-testid":"git-dropdown","aria-label":"Git Sync",className:"flex h-[--line-height-sm] w-full items-center gap-2 px-[--padding-md] text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] disabled:opacity-100 aria-pressed:bg-[--hl-sm]",children:[e.jsx(m,{icon:"earth-americas",className:"size-4"}),e.jsx(tt,{orientation:"vertical",className:"h-4 border border-solid border-[--hl-sm] bg-[--color-bg]"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsx(m,{icon:"code-branch",className:"size-4"}),G&&e.jsx("div",{className:"absolute -bottom-1 -right-1 size-[10px] rounded-full bg-[--color-surprise]"})]}),e.jsx("span",{className:"flex-1 truncate",children:oe?"Error syncing with Insomnia Cloud":S}),e.jsxs("div",{className:"flex flex-shrink-0 items-center gap-1.5 text-xs text-[--color-font-secondary]",children:[pe&&e.jsx(m,{icon:"spinner",className:"w-3 animate-spin"}),e.jsxs("div",{className:"flex items-center gap-0.5 overflow-hidden",children:[e.jsx("span",{children:C}),e.jsx(m,{icon:"arrow-down",className:`w-2 ${ae&&"animate-down-loop"}`})]}),e.jsxs("div",{className:"flex items-center gap-0.5 overflow-hidden",children:[e.jsx("span",{children:A}),e.jsx(m,{icon:"arrow-up",className:`w-2 ${fe&&"animate-up-loop"}`})]})]})]}),e.jsx(U,{offset:8,className:"max-h-[85vh] max-w-xs select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] px-4 py-2 text-sm text-[--color-font] shadow-lg focus:outline-none",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{children:"Encrypted and synced securely to the cloud. Ideal for out of the box collaboration."}),G&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"size-[10px] rounded-full bg-[--color-surprise]"}),"There are pending changes to commit."]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("span",{children:C}),e.jsx(m,{icon:"arrow-down",className:"w-2"})]}),V]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("span",{children:A}),e.jsx(m,{icon:"arrow-up",className:"w-2"})]}),te]}),e.jsx("div",{className:"text-[--color-warning]",children:oe?`Error: ${oe}`:""})]})})]}),e.jsx(Pe,{className:"min-w-max max-w-lg overflow-hidden",placement:"top end",offset:8,children:e.jsxs(De,{"aria-label":"Insomnia Sync Menu",selectionMode:"single",disabledKeys:Ee.filter(F=>F.isDisabled).map(F=>F.id),onAction:F=>{Ee.find(ge=>ge.id===F)?.action()},className:"max-h-[85vh] max-w-lg select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-2 text-sm shadow-lg focus:outline-none",children:[oe&&e.jsx(Q,{className:"border-b border-solid border-[--hl-sm]",children:e.jsxs(Z,{className:"flex w-full items-center gap-2 overflow-hidden whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors focus:outline-none disabled:cursor-not-allowed aria-selected:font-bold","aria-label":oe,children:[e.jsx(m,{icon:"exclamation-triangle",className:"text-[--color-warning]"}),e.jsx("p",{className:"whitespace-normal",children:oe})]})}),!oe&&e.jsxs(h.Fragment,{children:[e.jsx(Q,{className:"border-b border-solid border-[--hl-sm]",children:e.jsx(Y,{items:ue,children:F=>e.jsxs(Z,{className:`flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold ${F.isActive?"font-bold":""}`,"aria-label":F.name,children:[e.jsx(m,{icon:F.icon,className:F.isActive?"text-[--color-success]":""}),e.jsx("span",{className:"truncate",children:F.name})]})})}),e.jsx(Q,{children:e.jsx(Y,{items:re,children:F=>e.jsxs(Z,{className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-disabled:cursor-not-allowed aria-disabled:opacity-30 aria-selected:font-bold","aria-label":F.name,children:[e.jsx(m,{icon:F.icon}),e.jsx("span",{children:F.name})]})})})]})]})})]}),t&&e.jsx(Us,{onHide:()=>o(!1)}),y&&e.jsx(Br,{branches:k,currentBranch:S,remoteBranches:E.filter(F=>!k.includes(F)),onClose:()=>{u(!1)}}),d&&c&&e.jsx(Lr,{branch:S,status:c,syncItems:de,onClose:()=>p(!1)}),r&&e.jsx(Ar,{history:se,onClose:()=>i(!1)})]})},Ra=()=>{const{activeProject:s,activeWorkspace:l,gitRepository:a,activeWorkspaceMeta:t}=ze(),{userSession:o}=es(),{features:r}=kt();if(!o.id)return null;if(!xe(s)&&!t?.gitRepositoryId&&!Se(s))return e.jsx(St,{});if(xe(s)&&!t?.gitRepositoryId)return e.jsx(_r,{workspace:l,project:s},l?._id);if(r.gitSync.enabled&&(t?.gitRepositoryId||!xe(s))){if(Se(s))return e.jsx(Ct,{gitRepository:a},a?._id);if(a)return e.jsx(Pr,{isInsomniaSyncEnabled:xe(s),gitRepository:a,showDeprecatedWarning:!Se(s)},a?._id)}return null},Ia=({organizationId:s,projectId:l,workspaceId:a,activeProject:t,activeWorkspace:o,activeRequest:r,activeRequestGroup:i,activeMockRoute:d,unitTestSuite:p})=>{const{appTabsRef:y,addTab:u,changeActiveTab:P,closeTabById:M}=er(),v=Bt(),[f,w]=Et(),g=h.useCallback(c=>c==="request"?`/organization/${s}/project/${l}/workspace/${a}/debug/request/${r?._id}`:c==="folder"?`/organization/${s}/project/${l}/workspace/${a}/debug/request-group/${i?._id}`:c==="collection"?`/organization/${s}/project/${l}/workspace/${a}/debug?doNotSkipToActiveRequest=true`:c==="environment"?`/organization/${s}/project/${l}/workspace/${a}/environment`:c==="runner"?`/organization/${s}/project/${l}/workspace/${a}/debug/runner${v.search}`:c==="mockServer"?`/organization/${s}/project/${l}/workspace/${a}/mock-server`:c==="mockRoute"?`/organization/${s}/project/${l}/workspace/${a}/mock-server/mock-route/${d?._id}`:c==="document"?`/organization/${s}/project/${l}/workspace/${a}/spec`:c==="test"?`/organization/${s}/project/${l}/workspace/${a}/test`:c==="testSuite"?`/organization/${s}/project/${l}/workspace/${a}/test/test-suite/${p?._id}`:"",[d?._id,r?._id,i?._id,v.search,s,l,p?._id,a]),N=c=>{for(const k in Te)if(At({path:Te[k],end:!0},c))return k;return null},x=h.useCallback(()=>{const c=f.get("folder");return c?`runner_${c}`:`runner_${a}`},[f,a]),B=h.useCallback(c=>{if(!c)return;const k=y?.current?.[s];if(c==="request")return k?.tabList.find(S=>S.id===r?._id);if(c==="folder")return k?.tabList.find(S=>S.id===i?._id);if(c==="runner"){const S=x();return k?.tabList.find(I=>I.id===S)}if(c==="mockRoute")return k?.tabList.find(S=>S.id===d?._id);if(c==="testSuite")return k?.tabList.find(S=>S.id===p?._id);if(["collection","document","environment","mockServer","test"].includes(c))return k?.tabList.find(S=>S.id===a)},[d?._id,r?._id,i?._id,y,x,s,p?._id,a]),j=h.useCallback(c=>c?c==="request"?r?._id||"":c==="folder"?i?._id||"":c==="runner"?x():c==="mockRoute"?d?._id||"":c==="testSuite"?p?._id||"":["collection","document","environment","mockServer","test"].includes(c)?a:"":"",[d?._id,r?._id,i?._id,x,p?._id,a]),n=h.useCallback(c=>{if(!c)return;if(c==="request")return{type:c,name:r?.name||"New Request",url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),projectName:t.name,workspaceName:o.name,tag:Ft(r),method:r?.method||""};if(c==="folder")return{type:c,name:i?.name||"My Folder",url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),projectName:t.name,workspaceName:o.name};if(["collection","document","environment","mockServer","test"].includes(c))return{type:c,name:o.name,url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),projectName:t.name,workspaceName:o.name};if(c==="runner")return{type:c,name:"Runner",url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),projectName:t.name,workspaceName:o.name};if(c==="mockRoute")return{type:c,name:d?.name||"Untitled mock route",url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),tag:Pt(d?.method||""),projectName:t.name,workspaceName:o.name,method:d?.method||""};if(c==="testSuite")return{type:c,name:p?.name||"Untitled test suite",url:g(c),organizationId:s,projectId:l,workspaceId:a,id:j(c),projectName:t.name,workspaceName:o.name}},[d?.method,d?.name,t.name,r,i?.name,o.name,g,j,s,l,p?.name,a]);h.useEffect(()=>{const c=N(v.pathname),k=B(c);if(!k&&c){const E=n(c);if(E){let S=!1;if((c==="request"||c==="folder"||c==="collection")&&!f.get("created")&&(S=!0),f.get("created")){const I=new URLSearchParams(f);I.delete("created"),w(I)}u({...E,temporary:S});return}}k&&y?.current?.[s]?.activeTabId!==k.id&&P(k.id,{navigate:!1})},[u,y,P,B,v.pathname,s,n,f,w]),Ue({close_tab:c=>{c.preventDefault();const k=y?.current?.[s]?.activeTabId;k&&M(k)}})};export{La as $,_a as W,Ga as a,Ra as b,Ia as u};
//# sourceMappingURL=use-insomnia-tab-DPK2smQu.js.map
