import{r as l}from"./index-b8gibUUP.js";import{h as n}from"./chunk-WY5IRSCW-1dc6FieG.js";import{u as j,m as s}from"./chunk-OIYGIGL5-BYynBxW5.js";import{u as z,f as m,S as d,h as g,j as p,e as I,k as f,l as h,b as w}from"./index-BnTlsbFl.js";var S=(a=>(a[a.SyncOrganization=0]="SyncOrganization",a[a.MigrateProjects=1]="MigrateProjects",a[a.SyncProjects=2]="SyncProjects",a))(S||{});const k=a=>{const c=s({path:"/organization/:organizationId/project/:projectId/workspace/:workspaceId",end:!1},a),r=s({path:"/organization/:organizationId/project/:projectId",end:!1},a);return c||r},O=async({organizationId:a,navigateToWorkspace:c=!1})=>{const r=localStorage.getItem(`locationHistoryEntry:${a}`);if(r){const t=k(r);if(t&&t.params.organizationId&&t.params.projectId){const e=await I.getById(t.params.projectId);if(e){if(console.log("Redirecting to last visited project",e._id),t.params.workspaceId&&c){const i=await f.getById(t.params.workspaceId);if(i)return`${n("/organization/:organizationId/project/:projectId/workspace/:workspaceId",{organizationId:t.params.organizationId,projectId:e._id,workspaceId:i._id})}/${h(i.scope)}`}return n("/organization/:organizationId/project/:projectId",{organizationId:t.params.organizationId,projectId:e._id})}}}const o=await w.findOne(I.type,{parentId:a});return o?._id?n("/organization/:organizationId/project/:projectId",{organizationId:a,projectId:o._id}):n("/organization/:organizationId/project",{organizationId:a})},C=async()=>{try{if(!!!window.localStorage.getItem("hasSeenOnboardingV12"))return n("/onboarding/*",{"*":""});const c=window.localStorage.getItem("hasUserLoggedInBefore"),r=await z.getOrCreate();if(r.id){const o=JSON.parse(localStorage.getItem(`${r.accountId}:organizations`)||"[]"),t=m(o,r.accountId);if(!t)return n("/organization");let e=t.id;try{const i=localStorage.getItem("lastVisitedOrganizationId");i&&o.find(u=>u.id===i)&&(e=i)}catch{}return{pathname:await O({organizationId:e,navigateToWorkspace:!0}),state:{asyncTaskList:[0,1,2]}}}return c?n("/auth/login"):n("/organization/:organizationId/project/:projectId/workspace/:workspaceId/debug",{organizationId:p,projectId:g,workspaceId:d})}catch{return n("/organization/:organizationId/project/:projectId/workspace/:workspaceId/debug",{organizationId:p,projectId:g,workspaceId:d})}},R=(a,c)=>(...r)=>{const o=j(...r),t=l.useCallback(((...e)=>a(o.submit)(...e)),[o.submit]);return{...o,submit:t}},A=(a,c)=>(...r)=>{const o=j(...r),t=l.useCallback(((...e)=>a(o.load)(...e)),[o.load]);return{...o,load:t}};export{S as A,C as a,A as b,R as c,O as g};
//# sourceMappingURL=router-BoVIwh1i.js.map
