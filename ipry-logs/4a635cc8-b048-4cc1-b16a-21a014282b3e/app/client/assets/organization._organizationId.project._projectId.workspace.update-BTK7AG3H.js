import{k as p,K as l,z as f,e as d,J as k,w as u,ag as s}from"./index-BnTlsbFl.js";import{h as w}from"./chunk-WY5IRSCW-1dc6FieG.js";import{S as g}from"./analytics-fpOjxorv.js";import{i as n}from"./invariant-DVddvGrP.js";import{c as y}from"./router-BoVIwh1i.js";function S(o){return o.replace(".yaml","").replace(".yml","").toLowerCase().trim().replace(/[^a-z0-9_-]/g,"_")}function h(o){return`${S(o)}.yaml`}async function W({request:o}){const e=await o.json(),r=e.workspaceId;n(typeof r=="string","Workspace ID is required");const a=await p.getById(r);if(n(a,"Workspace not found"),a.scope==="design"){const t=await l.getByParentId(r);n(t,"No Api Spec found for this workspace"),await l.update(t,{fileName:e.name||a.name})}if(a.scope==="mock-server"){const t=await f.getByParentId(r);n(t,"No MockServer found for this workspace");let c=t.useInsomniaCloud;e.mockServerType&&typeof e.mockServerType=="string"&&(c=e.mockServerType==="cloud");let i=t.url;e.mockServerUrl&&typeof e.mockServerUrl=="string"&&(i=e.mockServerUrl),await f.update(t,{name:e.name||a.name,useInsomniaCloud:c,url:i}),window.main.trackSegmentEvent({event:g.mockEdit})}e.name=e.name||a.name||(a.scope==="collection"?"My Collection":"my-spec.yaml"),await p.update(a,e);const m=await d.getById(a.parentId);if(n(m,"Project not found"),k(m)){const t=await u.getOrCreateByParentId(a._id),c=s.dirname(t.gitFilePath||"");let i=s.basename(t.gitFilePath||"");e.fileName&&typeof e.fileName=="string"&&(i=e.fileName),await u.update(t,{gitFilePath:s.join(c,h(i))})}return{success:!0}}const C=y(o=>({organizationId:e,projectId:r,patch:a})=>o(JSON.stringify(a),{method:"POST",action:w("/organization/:organizationId/project/:projectId/workspace/update",{organizationId:e,projectId:r}),encType:"application/json"}));export{S as a,W as c,h as s,C as u};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace.update-BTK7AG3H.js.map
