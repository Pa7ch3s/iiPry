import{w as ie,N as se}from"./chunk-OIYGIGL5-BYynBxW5.js";import{j as t}from"./jsx-runtime-cpqHEc2t.js";import{r as u}from"./index-b8gibUUP.js";import{u as ae,$ as le,a as T,W as ce,b as me}from"./use-insomnia-tab-DPK2smQu.js";import{$ as R,a as de}from"./Button-Pc6dXscm.js";import{u as pe,a as ue,$ as fe,b as xe,I as he,c as be,d as ge,O as ve,e as ye,f as we}from"./trial.start-yrr1pYcE.js";import{$ as je}from"./Heading-CJLhoRaQ.js";import{$ as V,a as L,b as F,c as M,s as $e}from"./index-CiWR7xsz.js";import{$ as Ee}from"./Text-CNZDhubC.js";import{$ as N,A as Ie}from"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.update-CJN0pku1.js";import{P as Se,a as O,b as Ne}from"./error-boundary-qQv-jeYH.js";import{u as _e,q as Pe,r as Ke,t as z,v as y,x as ke,D as De,y as Ae}from"./index-BnTlsbFl.js";import{u as Ce}from"./organization._organizationId.project._projectId.workspace._workspaceId.environment.create-C5SrSIuz.js";import{u as Te}from"./organization._organizationId.project._projectId.workspace._workspaceId.environment.delete-Bbtl6Atl.js";import{u as Re}from"./organization._organizationId.project._projectId.workspace._workspaceId.environment.duplicate-MRGgtgUo.js";import{u as Ve}from"./organization._organizationId.project._projectId.workspace._workspaceId.environment.update-BFDmExsV.js";import{E as B}from"./editable-input-CP0Ibhfa.js";import{h as Le,E as Fe,a as Me}from"./key-value-editor-CPoqROww.js";import{I as m}from"./icon-pbM3MSP9.js";import"./_commonjsHelpers-CE1G-McA.js";import"./utils-BWA8Q1_N.js";import"./index-BBURUpBQ.js";import"./chunk-WY5IRSCW-1dc6FieG.js";import"./organization._organizationId.project._projectId.workspace.update-BTK7AG3H.js";import"./analytics-fpOjxorv.js";import"./invariant-DVddvGrP.js";import"./router-BoVIwh1i.js";import"./index-wZAP8gf2.js";import"./import-DfaWnrdO.js";import"./sax-DTOkft0z.js";import"./format-i_2FlR3N.js";import"./event-bus-gjQB7sSy.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.mock-server.generate-request-collection-DcBFb32H.js";import"./git.branch.checkout-24mct9lT.js";import"./git.fetch-V7uv_IT7.js";import"./git.push-C-wcZJjF.js";import"./git.repo-BBQti4ki.js";import"./git.reset-DI5KZlh1.js";import"./git.status-qLD8fOhB.js";import"./git.branch.delete-BnBpM4jO.js";import"./git.branch.new-BvBAmjXB.js";import"./git.branches-DSfOBTH4.js";import"./git.changes-CufBSoA0.js";import"./git.log-VScJjeAs.js";import"./git.update-Ct4Hysyl.js";import"./tooltip-BiEx1s0w.js";import"./index-B0jEcytd.js";import"./useControlledState-CVI9bVg4.js";import"./PortalProvider-CgpNn0eI.js";import"./git.commit-BOTBEKdr.js";import"./git.diff-rvyD93UG.js";import"./git.stage-WRvQ9YR0.js";import"./git.unstage-BG9AvbEd.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.checkout-BFdhyIzf.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.pull-BJpkfRkS.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.push-CfM5amSb.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.rollback-DbuDWqiP.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.create-BD-JEB_S.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.delete-Ck9dZ7bb.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.branch.merge-C_Hlo7i6.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.fetch-DiAT7xDA.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.restore-DzaYuRyT.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.create-snapshot-DMfKO0YH.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.stage-DakA5DCx.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.insomnia-sync.unstage-fOL91F5Y.js";import"./ai.generate-commit-messages-D7XzOLO8.js";import"./index-DkUPaXby.js";import"./insomnia-fetch-B_XbrnGh.js";import"./organization._organizationId.project.new-D3C_sj1w.js";import"./RSPContexts-DCUrjzvU.js";import"./VisuallyHidden-DFfuR22R.js";import"./migrate-projects-into-organization-CxpdXy_W.js";import"./Form-xjwDMhyX.js";import"./lodash-CnYLY2KZ.js";import"./auth.authorize-CVUDGUam.js";import"./auth-session-provider.client-B6EymBM1.js";import"./session-Dp07jz9w.js";import"./vault-key.client-BYwC5SBL.js";import"./auth.default-browser-redirect-Dz15uuKH.js";import"./auth.logout-Bgkq1Ur9.js";import"./cloud-credentials.create-D29FOB74.js";import"./git-credentials.github.complete-sign-in-QUucA-_J.js";import"./git-credentials.gitlab.complete-sign-in-iSdK124j.js";import"./import.scan-CIM-8ira.js";import"./trial.check-st6_Q4W5.js";import"./untracked-projects-Dxl3yYQQ.js";import"./commands-CpETkOnR.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request.new-mock-send-DTyjZaRX.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.mock-server.mock-route._mockRouteId.update-L_Ehr73N.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId-CCT5t53Y.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request-group._requestGroupId-ClXMvU4m.js";import"./index-9z9WB_nm.js";import"./xpath-V_VlYgIe.js";import"./index-BKSSlv8C.js";import"./index-BMm92w-c.js";import"./git.migrate-legacy-insomnia-folder-to-file-Cn4qXbei.js";import"./git.commits-C721-25t.js";import"./git.discard-yWCe4llX.js";import"./organization._organizationId.permissions-ce3pUO4N.js";import"./git.remote-branches-D25XWswd.js";import"./git-credentials.github-eh2MnRiC.js";import"./git-credentials.github.init-sign-in-MvedveJK.js";import"./git-credentials.github.sign-out-HzzMex4W.js";import"./git-credentials.gitlab-C9jV75uM.js";import"./git-credentials.gitlab.init-sign-in-DZFf8KTH.js";import"./git-credentials.gitlab.sign-out-DlPqV6dO.js";import"./organization._organizationId.project._projectId.delete-Zh6QxqDG.js";import"./git.init-clone-Bwgsynf-.js";import"./organization._organizationId.project._projectId.update-CnIPYBnW.js";import"./insomnia-icon-DsDa0lSD.js";import"./organization._organizationId.project._projectId.move-CGW0jVUY.js";import"./organization._organizationId.project._projectId.move-workspace-CWMxcFOA.js";import"./git.repository-tree-jzi-oT2U.js";import"./git.clone-Dz6ZsdrO.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request.new-DZNrbQ0p.js";import"./auth.clear-vault-key-B0vAvdAY.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.environment.set-active-DQD_GOKm.js";import"./remote-files-QiiU5lTV.js";import"./organization._organizationId.collaborators-BP2ctKnQ.js";import"./organization._organizationId.collaborators.invites._invitationId-hJMODP0K.js";import"./organization._organizationId.collaborators.invites._invitationId.reinvite-i6_4wOiO.js";import"./organization._organizationId.collaborators-check-seats-DsqfBJzh.js";import"./organization._organizationId.members._userId.roles-D3CH43Zf.js";import"./organization._organizationId.collaborators-search-DSW9uxb9.js";import"./resource.usage-CbBoS-Ts.js";import"./organization._organizationId.project._projectId-CtDmbbW4.js";import"./cloud-credentials._cloudCredentialId.delete-CHPMwoBx.js";import"./cloud-credentials._cloudCredentialId.update-RaJlpXVy.js";import"./auth.create-vault-key-B-0jQzTT.js";import"./auth.update-vault-salt-BBWvZ0Tc.js";import"./auth.reset-vault-key-YbpkP1rp.js";import"./auth.validate-vault-key-UWRH3JbX.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.update-meta-CRlGCFc9.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.update-payload-DHsO7wRp.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request-group._requestGroupId.update-BcedaLUm.js";import"./organization._organizationId.project._projectId.workspace._workspaceId.debug.request-group._requestGroupId.update-meta-szcm3PeP.js";import"./settings.update-BK5WtJcK.js";async function vr(w){const x=await _e.get();return{vaultKey:x.vaultKey?await Pe(x.vaultKey,!1):""}}const Oe=({loaderData:w,params:x})=>{const{organizationId:s,projectId:a,workspaceId:n}=x,{vaultKey:H}=w,W=pe(),j=u.useRef(null),{features:q}=ue(),_=Ce(),G=Te(),d=Ve(),U=Re(),{activeProject:$,baseEnvironment:h,activeEnvironment:J,subEnvironments:c,activeWorkspaceMeta:P,activeWorkspace:Z}=W,[E,K]=u.useState(J._id),b=!!(Ke($)&&!P?.gitRepositoryId),g=!!(q.gitSync.enabled&&P?.gitRepositoryId),k=[h,...c],r=k.find(e=>e._id===E),Q=!r?.kvPairData?.some(e=>e.type===z.SECRET),X=k.some(e=>e.isPrivate&&e.kvPairData?.some(o=>o.type===z.SECRET))&&!w.vaultKey,[Y,ee]=u.useState(X),D=[{id:"duplicate",name:"Duplicate",icon:"copy",action:async e=>{U.submit({organizationId:s,projectId:a,workspaceId:n,environmentId:e._id})}},{id:"delete",name:"Delete",icon:"trash",action:async e=>{$e(Ie,{title:"Delete Environment",message:`Are you sure you want to delete "${e.name}"?`,addCancel:!0,okLabel:"Delete",onConfirm:async()=>{G.submit({organizationId:s,projectId:a,workspaceId:n,environmentId:e._id}),K(h._id)}})}}],A=[{id:"shared",name:"Shared environment",description:`${g?"Synced with Git Sync and exportable":b?"Synced with Insomnia Sync and exportable":"Exportable"}`,icon:g?["fab","git-alt"]:b?"globe-americas":"file-arrow-down",action:async()=>{_.submit({organizationId:s,projectId:a,workspaceId:n,params:{isPrivate:!1}})}},{id:"private",name:"Private environment",description:"Local and not exportable",icon:"lock",action:async()=>{_.submit({organizationId:s,projectId:a,workspaceId:n,params:{isPrivate:!0}})}}],te=ke(e=>{if(j.current?.isValid()&&r){const{object:o,propertyOrder:i}=e;d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{data:o,dataPropertyOrder:i},environmentId:r._id})}},500),oe=e=>{if(r){const o=Ae(e);d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{data:o.data,dataPropertyOrder:o.dataPropertyOrder,kvPairData:e},environmentId:r._id})}},re=fe({getItems:e=>[...e].map(o=>({"text/plain":o.toString()})),onReorder(e){const o=[...e.keys][0],i=c.find(p=>p._id===o),l=c.find(p=>p._id===e.target.key);if(!i||!l)return;const v=e.target.dropPosition;if(v==="before"){const p=c.findIndex(S=>S._id===l._id),f=c[p-1];f?i.metaSortKey=(f.metaSortKey+l.metaSortKey)/2:i.metaSortKey=l.metaSortKey-1}if(v==="after"){const p=c.findIndex(S=>S._id===l._id),f=c[p+1];f?i.metaSortKey=(f.metaSortKey+l.metaSortKey)/2:i.metaSortKey=l.metaSortKey+1}d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{metaSortKey:i.metaSortKey},environmentId:i._id})},renderDropIndicator(e){return e.type==="item"?e.dropPosition==="before"&&e.key===h._id?t.jsx(N,{target:e,className:"hidden"}):t.jsx(N,{target:e,className:"outline outline-1 outline-[--color-surprise]"}):t.jsx(N,{target:e,className:"outline outline-1 outline-[--color-surprise]"})}}),I=u.useRef(null);function C(){const e=I.current?.getLayout();e&&(e&&e[0]>0?e[0]=0:e[0]=De,I.current?.setLayout(e))}const ne=()=>{ee(!1)};return u.useEffect(()=>window.main.on("toggle-sidebar",C),[]),xe({sidebar_toggle:C}),ae({organizationId:s,projectId:a,workspaceId:n,activeWorkspace:Z,activeProject:$}),t.jsxs(Se,{ref:I,autoSaveId:"insomnia-sidebar",id:"wrapper",className:"new-sidebar h-full w-full text-[--color-font]",direction:"horizontal",children:[t.jsxs(O,{id:"sidebar",className:"sidebar theme--sidebar flex flex-col justify-between divide-y divide-solid divide-[--hl-md] overflow-hidden",maxSize:40,minSize:10,collapsible:!0,children:[t.jsx("div",{className:"flex flex-col items-start",children:t.jsxs(le,{className:`flex h-[${he}px] m-0 w-full list-none items-center gap-2 px-[--padding-sm] font-bold`,children:[t.jsxs(T,{className:"flex h-full select-none items-center gap-2 text-[--color-font] outline-none data-[focused]:outline-none",children:[t.jsx(se,{"data-testid":"project",className:"flex aspect-square h-7 flex-shrink-0 items-center justify-center gap-2 rounded-sm px-1 py-1 text-sm text-[--color-font] outline-none ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] aria-pressed:bg-[--hl-sm] data-[focused]:outline-none",to:`/organization/${s}/project/${$._id}`,children:t.jsx(m,{className:"text-xs",icon:"chevron-left"})}),t.jsx("span",{"aria-hidden":!0,role:"separator",className:"h-4 text-[--hl-lg] outline outline-1"})]}),t.jsx(T,{className:"flex h-full select-none items-center gap-2 truncate text-[--color-font] outline-none data-[focused]:outline-none",children:t.jsx(ce,{})})]})}),t.jsx(be,{"aria-label":"Environments",items:[h,...c],className:"w-full flex-1 flex-shrink-0 overflow-y-auto py-[--padding-xs] data-[empty]:py-0",disallowEmptySelection:!0,selectionMode:"single",selectionBehavior:"replace",selectedKeys:[E],dragAndDropHooks:re.dragAndDropHooks,onSelectionChange:e=>{if(e!=="all"){const[o]=e.values();K(o.toString())}},children:e=>t.jsx(ge,{id:e._id,textValue:e.name,className:"group select-none outline-none",children:t.jsxs("div",{className:`${e.parentId===n?"pl-4":"pl-8"} relative flex h-[--line-height-xs] w-full select-none items-center gap-2 overflow-hidden pr-4 text-[--hl] outline-none transition-colors group-hover:bg-[--hl-xs] group-focus:bg-[--hl-sm] group-aria-selected:text-[--color-font]`,children:[t.jsx("span",{className:"absolute left-0 top-0 h-full w-[2px] bg-transparent transition-colors group-aria-selected:bg-[--color-surprise]"}),t.jsx(m,{icon:e.isPrivate?"lock":g?["fab","git-alt"]:b?"globe-americas":"file-arrow-down",className:"w-5",style:{color:e.color||void 0}}),t.jsx(B,{value:e.name,name:"name",ariaLabel:"Environment name",className:"flex-1 px-1 hover:!bg-transparent",onSubmit:o=>{o&&d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{name:o},environmentId:e._id})}}),e.parentId!==n&&t.jsxs(V,{children:[t.jsx(R,{"aria-label":"Project Actions",className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] opacity-0 ring-1 ring-transparent transition-all hover:bg-[--hl-xs] hover:opacity-100 focus:opacity-100 focus:ring-inset focus:ring-[--hl-md] group-hover:opacity-100 group-focus:opacity-100 data-[pressed]:bg-[--hl-sm] data-[pressed]:opacity-100",children:t.jsx(m,{icon:"caret-down"})}),t.jsx(L,{className:"flex min-w-max flex-col overflow-y-hidden",children:t.jsx(F,{"aria-label":"Environment Actions",selectionMode:"single",onAction:o=>{D.find(({id:i})=>o===i)?.action(e)},items:D,className:"min-w-max select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-2 text-sm shadow-lg focus:outline-none",children:o=>t.jsxs(M,{id:o.id,className:"flex h-[--line-height-xs] w-full items-center gap-2 whitespace-nowrap bg-transparent px-[--padding-md] text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-selected:font-bold","aria-label":o.name,children:[t.jsx(m,{className:"w-5",icon:o.icon}),t.jsx("span",{children:o.name})]},o.id)})})]}),e.parentId===n&&t.jsxs(V,{children:[t.jsx(R,{"aria-label":"Create Environment","data-testid":"CreateEnvironmentDropdown",className:"flex aspect-square h-6 items-center justify-center rounded-sm text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] data-[pressed]:bg-[--hl-sm]",children:t.jsx(m,{icon:"plus-circle"})}),t.jsx(L,{className:"flex min-w-max flex-col overflow-y-hidden",children:t.jsx(F,{"aria-label":"New Environment",selectionMode:"single",onAction:o=>{A.find(({id:i})=>o===i)?.action(e)},items:A,className:"min-w-max select-none overflow-y-auto rounded-md border border-solid border-[--hl-sm] bg-[--color-bg] py-2 text-sm shadow-lg focus:outline-none",children:o=>t.jsxs(M,{id:o.id,className:"flex w-full flex-col gap-1 whitespace-nowrap bg-transparent px-[--padding-md] py-2 text-[--color-font] transition-colors hover:bg-[--hl-sm] focus:bg-[--hl-xs] focus:outline-none disabled:cursor-not-allowed aria-selected:font-bold","aria-label":o.name,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(m,{className:"w-5",icon:o.icon}),t.jsx("span",{children:o.name})]}),t.jsx(Ee,{slot:"description",className:"text-xs text-[--hl]",children:o.description})]},o.id)})})]})]})},e._id)}),t.jsx(me,{})]}),t.jsx(Ne,{className:"h-full w-[1px] bg-[--hl-md]"}),t.jsxs(O,{id:"pane-one",className:"pane-one theme--pane flex flex-col",children:[t.jsx(ve,{}),t.jsxs("div",{className:"flex flex-1 flex-col divide-y divide-solid divide-[--hl-md] overflow-hidden",children:[t.jsxs("div",{className:"flex w-full flex-shrink-0 basis-[--line-height-sm] items-center justify-between gap-2 overflow-hidden p-[--padding-sm]",children:[t.jsxs(je,{className:"flex flex-grow items-center gap-2 overflow-hidden px-4 py-2 text-lg",children:[t.jsx(m,{className:"w-4",icon:r?.isPrivate?"lock":g?["fab","git-alt"]:b?"globe-americas":"file-arrow-down"}),t.jsx(B,{value:r?.name||"",name:"name",ariaLabel:"Environment name",className:"flex-1 px-1",onSubmit:e=>{e&&d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{name:e},environmentId:E})}})]}),r&&r.parentId!==n&&t.jsxs(de,{className:"ml-auto mr-2 flex flex-shrink-0 items-center gap-2 rounded-sm bg-[--hl-sm] px-2 py-1 text-sm text-[--color-font] ring-1 ring-transparent transition-all hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md] data-[pressed]:bg-[--hl-sm]",children:[t.jsx("span",{children:"Color:"}),t.jsx("input",{onChange:e=>{const o=e.target.value;d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{color:o},environmentId:r._id})},type:"color",value:r?.color||""})]}),r&&Q&&t.jsx(ye,{onChange:e=>{const o=(l,v)=>{d.submit({organizationId:s,projectId:a,workspaceId:n,patch:{environmentType:l,kvPairData:v},environmentId:r._id})},i=!!j.current?.isValid();Le(e,r,i,o)},isSelected:r?.environmentType!==y.KVPAIR,className:"flex w-[14ch] flex-shrink-0 items-center justify-start gap-2 rounded-sm px-2 py-1 text-sm text-[--color-font] ring-1 ring-transparent transition-colors hover:bg-[--hl-xs] focus:ring-inset focus:ring-[--hl-md]","aria-label":r?.environmentType!==y.KVPAIR?"Table Edit":"Raw Edit",children:({isSelected:e})=>t.jsxs(u.Fragment,{children:[t.jsx(m,{icon:e?"toggle-off":"toggle-on",className:`${e?"":"text-[--color-success]"}`}),t.jsx("span",{children:"Table View"})]})})]}),r&&(r.environmentType===y.JSON||!r.environmentType)&&t.jsx(Fe,{ref:j,onChange:te,environmentInfo:{object:r.data,propertyOrder:r.dataPropertyOrder}},r._id),r&&r.environmentType===y.KVPAIR&&t.jsx(Me,{data:r.kvPairData||[],isPrivate:r.isPrivate,onChange:oe,vaultKey:H},r._id),Y&&t.jsx(we,{onClose:ne,allowClose:!1})]})]})]})},yr=ie(Oe);export{vr as clientLoader,yr as default};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.environment-DtV3WbI7.js.map
