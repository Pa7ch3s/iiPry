import{h as I}from"./chunk-WY5IRSCW-1dc6FieG.js";import{r as w}from"./chunk-OIYGIGL5-BYynBxW5.js";import{z as p,B as k,k as f}from"./index-BnTlsbFl.js";import{S as h}from"./analytics-fpOjxorv.js";import{i as t}from"./invariant-DVddvGrP.js";import{c as g}from"./router-BoVIwh1i.js";async function P({request:s,params:m}){const{organizationId:c,projectId:r,workspaceId:d}=m;try{const e=await s.json();if(t(typeof e.name=="string","Name is required"),t(e.name.startsWith("/"),"Path must begin with a /"),e.parentId){const a=await p.getById(e.parentId),n=await k.findByParentId(e.parentId);a?.useInsomniaCloud?n.find(o=>o.name===e.name)&&t(!1,`Path "${e.name}" already exists. Please enter a different path.`):n.find(o=>o.name===e.name&&o.method.toUpperCase()===e.method?.toUpperCase())&&t(!1,`Path "${e.name}" with ${e.method} method already exists. Please enter a different path or method.`)}if(e.mockServerName){const a=await f.getById(d);t(a,"Collection workspace not found");const n=await f.create({name:a.name,scope:"mock-server",parentId:r});t(n,"Workspace not found");const i=await p.getOrCreateForParentId(n._id,{name:a.name});delete e.mockServerName;const o=await k.create({...e,parentId:i._id});return window.main.trackSegmentEvent({event:h.mockRouteCreate}),w(I("/organization/:organizationId/project/:projectId/workspace/:workspaceId/mock-server/mock-route/:mockRouteId",{organizationId:c,projectId:r,workspaceId:i.parentId,mockRouteId:o._id}))}t(e.parentId,"parentId is required");const u=await p.getById(e.parentId);t(u,"Mock server not found");const v=await k.create(e);return window.main.trackSegmentEvent({event:h.mockRouteCreate}),w(I("/organization/:organizationId/project/:projectId/workspace/:workspaceId/mock-server/mock-route/:mockRouteId",{organizationId:c,projectId:r,workspaceId:u.parentId,mockRouteId:v._id}))}catch(e){return console.error("Error creating mock route:",e),{error:e instanceof Error?e.message:"Failed to create mock route"}}}const C=g(s=>({organizationId:m,projectId:c,workspaceId:r,patch:d})=>s(JSON.stringify(d),{method:"POST",action:I("/organization/:organizationId/project/:projectId/workspace/:workspaceId/mock-server/mock-route/new",{organizationId:m,projectId:c,workspaceId:r}),encType:"application/json"}));export{P as c,C as u};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.mock-server.mock-route.new-C3GYuFkd.js.map
