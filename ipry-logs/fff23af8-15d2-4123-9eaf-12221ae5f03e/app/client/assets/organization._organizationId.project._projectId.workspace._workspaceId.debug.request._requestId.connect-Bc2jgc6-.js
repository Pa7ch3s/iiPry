import{h as w}from"./chunk-WY5IRSCW-1dc6FieG.js";import{cH as l,bZ as q,co as k,cn as I,aP as R,cL as S,b$ as f,cU as A}from"./index-BnTlsbFl.js";import{ap as g}from"./index-wZAP8gf2.js";import{i as p}from"./invariant-DVddvGrP.js";import{c as P}from"./router-BoVIwh1i.js";const T="graphql-transport-ws";var h;(function(t){t[t.InternalServerError=4500]="InternalServerError",t[t.InternalClientError=4005]="InternalClientError",t[t.BadRequest=4400]="BadRequest",t[t.BadResponse=4004]="BadResponse",t[t.Unauthorized=4401]="Unauthorized",t[t.Forbidden=4403]="Forbidden",t[t.SubprotocolNotAcceptable=4406]="SubprotocolNotAcceptable",t[t.ConnectionInitialisationTimeout=4408]="ConnectionInitialisationTimeout",t[t.ConnectionAcknowledgementTimeout=4504]="ConnectionAcknowledgementTimeout",t[t.SubscriberAlreadyExists=4409]="SubscriberAlreadyExists",t[t.TooManyInitialisationRequests=4429]="TooManyInitialisationRequests"})(h||(h={}));var s;(function(t){t.ConnectionInit="connection_init",t.ConnectionAck="connection_ack",t.Ping="ping",t.Pong="pong",t.Subscribe="subscribe",t.Next="next",t.Error="error",t.Complete="complete"})(s||(s={}));async function _({params:t,request:o}){const{requestId:e,workspaceId:r}=t,i=await l(e);p(i,"Request not found"),p(r,"Workspace ID is required");const n=await o.json();if(q(e)&&window.main.webSocket.open({requestId:e,workspaceId:r,url:n.url,headers:n.headers,authentication:n.authentication,cookieJar:n.cookieJar}),k(i)&&window.main.webSocket.open({requestId:e,workspaceId:r,url:n.url.replace("http","ws").replace("https","wss"),headers:[...n.headers,{name:"sec-websocket-protocol",value:T}],isGraphqlSubscriptionRequest:!0,initialPayload:JSON.stringify({type:s.ConnectionInit}),authentication:n.authentication,cookieJar:n.cookieJar}),I(i)){const a={...i,...n},c=await g(a,n.url);window.main.curl.open({requestId:e,workspaceId:r,url:n.url,headers:n.headers,authHeader:c,authentication:n.authentication,cookieJar:n.cookieJar,suppressUserAgent:n.suppressUserAgent})}return R(i)&&window.main.socketIO.open({requestId:e,workspaceId:r,url:n.url,headers:n.headers,cookieJar:n.cookieJar,authentication:n.authentication,query:n.query||{}}),S(i)?window.main.mcp.connect({requestId:e,workspaceId:r,transportType:n.transportType||f.HTTP,url:n.url,headers:n.headers,authentication:n.authentication,env:n.env||{}}):new Promise(a=>{const c=window.main.on("db.changes",async(v,d)=>{for(const m of d){const[b,u]=m;if(A(u)&&u.parentId===e&&b==="update"){a(null),c();return}}})})}const H=P(t=>({organizationId:o,projectId:e,workspaceId:r,requestId:i,connectParams:n})=>{const a=w("/organization/:organizationId/project/:projectId/workspace/:workspaceId/debug/request/:requestId/connect",{organizationId:o,projectId:e,workspaceId:r,requestId:i});return t(JSON.stringify(n),{action:a,method:"POST",encType:"application/json"})});export{_ as c,H as u};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.debug.request._requestId.connect-Bc2jgc6-.js.map
