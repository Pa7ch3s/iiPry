import{g as R,r as S,a as k}from"./unit-test-feature-CNk-Sfkl.js";import{h as u}from"./chunk-WY5IRSCW-1dc6FieG.js";import{r as c}from"./chunk-OIYGIGL5-BYynBxW5.js";import{b as v,aK as T,d6 as p}from"./index-BnTlsbFl.js";import{S as m}from"./analytics-fpOjxorv.js";import{i as h}from"./invariant-DVddvGrP.js";import{c as j}from"./router-BoVIwh1i.js";async function A({params:i}){const{organizationId:e,projectId:s,workspaceId:n,testSuiteId:o,testId:d}=i,t=await v.findOne(T.type,{_id:d});h(t,"Test not found");const l=[{name:t.name,code:t.code,defaultRequestId:t.requestId}],I=R([{name:"My Suite",suites:[],tests:l}]),f=k();let r={failures:[],passes:[],pending:[],stats:{suites:0,tests:0,passes:0,pending:0,failures:0,start:void 0,end:void 0,duration:void 0},tests:[]};try{r=await S(I,{sendRequest:f});const a=await p.create({results:r,parentId:t.parentId});return window.main.trackSegmentEvent({event:m.unitTestRun,properties:{organizationId:e,projectId:s}}),c(u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/test-result/:testResultId",{organizationId:e,projectId:s,workspaceId:n,testSuiteId:o,testResultId:a._id}))}catch(a){const g=a instanceof Error?a.message:String(a);r.stats.failures=1,r.stats.tests=1,r.tests.push({currentRetry:0,duration:0,err:{actual:void 0,expected:void 0,message:g,multiple:[],operator:void 0,showDiff:!1,stack:""},file:"",fullTitle:t.name,id:"",title:t.name});const w=await p.create({results:r,parentId:t.parentId});return window.main.trackSegmentEvent({event:m.unitTestRun,properties:{organizationId:e,projectId:s}}),c(u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/test-result/:testResultId",{organizationId:e,projectId:s,workspaceId:n,testSuiteId:o,testResultId:w._id}))}}const F=j(i=>({organizationId:e,projectId:s,workspaceId:n,testSuiteId:o,testId:d})=>{const t=u("/organization/:organizationId/project/:projectId/workspace/:workspaceId/test/test-suite/:testSuiteId/test/:testId/run",{organizationId:e,projectId:s,workspaceId:n,testSuiteId:o,testId:d});return i({},{action:t,method:"POST"})});export{A as c,F as u};
//# sourceMappingURL=organization._organizationId.project._projectId.workspace._workspaceId.test.test-suite._testSuiteId.test._testId.run-RgdWFNQ9.js.map
