import{h as i}from"./chunk-WY5IRSCW-1dc6FieG.js";import{u as c}from"./index-BnTlsbFl.js";import{v as u,s as l}from"./vault-key.client-BYwC5SBL.js";import{c as f}from"./router-BoVIwh1i.js";async function K({request:t}){const{vaultKey:e,saveVaultKey:s=!1}=await t.json(),r=await c.getOrCreate(),{vaultSalt:o,accountId:n}=r;if(!o)return{error:"Please generate a vault key from preference first"};try{const a=await u(r,e,o);return a?(s&&await l(n,e),{vaultKey:e,srpK:a}):{error:"Invalid vault key, please check and input again"}}catch(a){return{error:a instanceof Error?a.message:"An unknown error occurred"}}}const h=f(t=>({vaultKey:e,saveVaultKey:s=!1})=>{const r=i("/auth/validate-vault-key");return t(JSON.stringify({vaultKey:e,saveVaultKey:s}),{action:r,method:"POST",encType:"application/json"})});export{K as c,h as u};
//# sourceMappingURL=auth.validate-vault-key-UWRH3JbX.js.map
