import{e as E,f as P,b as T,a as U,g as Q,$ as _}from"./utils-BWA8Q1_N.js";import{r as o,R as b}from"./index-b8gibUUP.js";import{r as k,s as q,n as Y}from"./Button-Pc6dXscm.js";import{$ as z}from"./Text-CNZDhubC.js";function le(t,e,a){let i=E(()=>{a&&a(e)});o.useEffect(()=>{var n;let r=t==null||(n=t.current)===null||n===void 0?void 0:n.form;return r?.addEventListener("reset",i),()=>{r?.removeEventListener("reset",i)}},[t,i])}function ne(t){let{description:e,errorMessage:a,isInvalid:i,validationState:n}=t,{labelProps:r,fieldProps:s}=k(t),d=P([!!e,!!a,i,n]),u=P([!!e,!!a,i,n]);return s=T(s,{"aria-describedby":[d,u,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:r,fieldProps:s,descriptionProps:{id:d},errorMessageProps:{id:u}}}const S={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...S,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:S,validationErrors:[]},A=o.createContext({}),L="__formValidationState"+Date.now();function oe(t){if(t[L]){let{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:n,commitValidation:r}=t[L];return{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:n,commitValidation:r}}return G(t)}function G(t){let{isInvalid:e,validationState:a,name:i,value:n,builtinValidation:r,validate:s,validationBehavior:d="aria"}=t;a&&(e||(e=a==="invalid"));let u=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:R}:null,c=o.useMemo(()=>{if(!s||n==null)return null;let v=H(s,n);return B(v)},[s,n]);r?.validationDetails.valid&&(r=void 0);let l=o.useContext(A),f=o.useMemo(()=>i?Array.isArray(i)?i.flatMap(v=>M(l[v])):M(l[i]):[],[l,i]),[$,j]=o.useState(l),[w,V]=o.useState(!1);l!==$&&(j(l),V(!1));let g=o.useMemo(()=>B(w?[]:f),[w,f]),C=o.useRef(m),[h,x]=o.useState(m),p=o.useRef(m),N=()=>{if(!O)return;y(!1);let v=c||r||C.current;I(v,p.current)||(p.current=v,x(v))},[O,y]=o.useState(!1);return o.useEffect(N),{realtimeValidation:u||g||c||r||m,displayValidation:d==="native"?u||g||h:u||g||c||r||h,updateValidation(v){d==="aria"&&!I(h,v)?x(v):C.current=v},resetValidation(){let v=m;I(v,p.current)||(p.current=v,x(v)),d==="native"&&y(!1),V(!0)},commitValidation(){d==="native"&&y(!0),V(!0)}}}function M(t){return t?Array.isArray(t)?t:[t]:[]}function H(t,e){if(typeof t=="function"){let a=t(e);if(a&&typeof a!="boolean")return M(a)}return[]}function B(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:R}:null}function I(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((a,i)=>a===e.validationErrors[i])&&Object.entries(t.validationDetails).every(([a,i])=>e.validationDetails[a]===i)}function de(...t){let e=new Set,a=!1,i={...S};for(let s of t){var n,r;for(let d of s.validationErrors)e.add(d);a||(a=s.isInvalid);for(let d in i)(n=i)[r=d]||(n[r]=s.validationDetails[d])}return i.valid=!a,{isInvalid:a,validationErrors:[...e],validationDetails:i}}function se(t,e,a){let{validationBehavior:i,focus:n}=t;U(()=>{if(i==="native"&&a?.current&&!a.current.disabled){let c=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(c),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(K(a.current))}});let r=o.useRef(!1),s=E(()=>{r.current||e.resetValidation()}),d=E(c=>{var l;e.displayValidation.isInvalid||e.commitValidation();let f=a==null||(l=a.current)===null||l===void 0?void 0:l.form;if(!c.defaultPrevented&&a&&f&&W(f)===a.current){var $;n?n():($=a.current)===null||$===void 0||$.focus(),q("keyboard")}c.preventDefault()}),u=E(()=>{e.commitValidation()});o.useEffect(()=>{let c=a?.current;if(!c)return;let l=c.form,f=l?.reset;return l&&(l.reset=()=>{r.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,f?.call(l),r.current=!1}),c.addEventListener("invalid",d),c.addEventListener("change",u),l?.addEventListener("reset",s),()=>{c.removeEventListener("invalid",d),c.removeEventListener("change",u),l?.removeEventListener("reset",s),l&&(l.reset=f)}},[a,d,u,s,i])}function J(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function K(t){return{isInvalid:!t.validity.valid,validationDetails:J(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function W(t){for(let e=0;e<t.elements.length;e++){let a=t.elements[e];if(!a.validity.valid)return a}return null}const F=o.createContext(null),ce=o.forwardRef(function(e,a){let i=o.useContext(F);return i?.isInvalid?b.createElement(X,{...e,ref:a}):null}),X=o.forwardRef((t,e)=>{let a=o.useContext(F),i=Y(t,{global:!0}),n=Q({...t,defaultClassName:"react-aria-FieldError",defaultChildren:a.validationErrors.length===0?void 0:a.validationErrors.join(" "),values:a});return n.children==null?null:b.createElement(z,{slot:"errorMessage",...i,...n,ref:e})}),D=o.createContext(null),ve=o.forwardRef(function(e,a){[e,a]=_(e,a,D);let{validationErrors:i,validationBehavior:n="native",children:r,className:s,...d}=e;return b.createElement("form",{noValidate:n!=="native",...d,ref:a,className:s||"react-aria-Form"},b.createElement(D.Provider,{value:{...e,validationBehavior:n}},b.createElement(A.Provider,{value:i??{}},r)))});export{ve as $,ce as a,le as b,se as c,ne as d,oe as e,D as f,F as g,L as h,m as i,de as j};
//# sourceMappingURL=Form-xjwDMhyX.js.map
